define("c940c0cc-8b69-4bf3-831f-86631b8776d1_0.0.1",["@microsoft/sp-webpart-base","react","react-dom"],(e,t,n)=>(()=>{"use strict";var a={642:t=>{t.exports=e},959:e=>{e.exports=t},398:e=>{e.exports=n}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{default:()=>Gi});var e=r(642),t=r(959),n=r(398);function a(e,t,n){let a=new Date(e.toString());switch(t.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+n);break;case"quarter":a.setMonth(a.getMonth()+3*n);break;case"month":a.setMonth(a.getMonth()+n);break;case"week":a.setDate(a.getDate()+7*n);break;case"day":a.setDate(a.getDate()+n);break;case"hour":a.setTime(a.getTime()+36e5*n);break;case"minute":a.setTime(a.getTime()+6e4*n);break;case"second":a.setTime(a.getTime()+1e3*n);break;default:a=void 0}return a}function i(...e){return e.filter(e=>!u(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function s(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function c(e){return"function"==typeof e}function d(e){return Array.isArray(e)}function l(e){return/^https?:\/\/|^\/\//i.test(e)}function u(e){return null==e||e.length<1}function f(e){return null!=e}function p(e){return JSON.stringify(e)}function m(e,t){return Object.hasOwnProperty.call(e,t)}let _;function h(){return void 0===_&&(_=new g),_}class b{constructor(e){this.store=e,this.enabled=this.test()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!f(t))return null;const n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}put(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}delete(e){this.enabled&&this.store.removeItem(e)}async getOrPut(e,t,n){if(!this.enabled)return t();let a=this.get(e);return null===a&&(a=await t(),this.put(e,a,n)),a}async deleteExpired(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&await this.get(t)}}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){return void 0===t&&(t=a(new Date,"minute",5)),p({pnp:1,expiration:t,value:e})}}class g{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}function v(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function y(){return async function(e,...t){return[...e].reduce((e,t)=>e.then(e=>Reflect.apply(t,this,e)),Promise.resolve(t))}}function S(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t);return this}}const D=Symbol.for("ObserverLifecycleFlags"),I=e=>t=>!((t[D]||0)&e),x=e=>t=>(t[D]=(t[D]||0)|e,t),C=x(1);x(2);class O{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),w(e.observers,t,n,1),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,3),e),prepend:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,2),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){f(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!d(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?S():v();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}finally{a&&a.length>0&&Reflect.set(e.observers,t,a.filter(I(2)))}}})),this._emitProxy}start(e){this.emit.init();const t=this.execute(e);return t.finally(()=>{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}).catch(()=>{}),t}cloneObserversOnChange(){this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=E(this.observers))}}function w(e,t,n,a){if(!c(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case 1:e[t].push(n);break;case 2:e[t].unshift(n);break;case 3:e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}function E(e){return Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n].filter(I(1))],t),{})}function A(e){return t=>(t.observers=e.observers,t._inheritingObservers=!0,t)}function L(e,t="append",n){return a=>Reflect.apply(k,a,[e,t,n])}function k(e,t,n){if(!f(e)||!f(e.observers))return this;c(n)||(n=()=>!0);const a=E(e.observers),i=Object.keys(a).filter(n);for(let e=0;e<i.length;e++){const n=i[e],r=this.on[n];"replace"===t&&r.clear(),a[n].forEach(e=>r(e))}return this}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const M={construct:S(),pre:y(),auth:y(),send:async function(e,...t){if(!d(e)||e.length<1)return;const n=e[0];return Reflect.apply(n,this,t)},parse:y(),post:y(),data:v()};let P=class extends O{constructor(e,t){let n;if(super(M),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=function(e,...t){return[...e].reduce((e,t)=>Reflect.apply(t,this,e),t)},"string"==typeof e)this._url=i(e,t);else if(d(e)){if(2!==e.length)throw Error("When using the tuple param exactly two arguments are expected.");if("string"!=typeof e[1])throw Error("Expected second tuple param to be a string.");n=e[0],this._url=i(e[1],t)}else n=e,this._url=i(n._url,t);void 0!==n&&(this.observers=n.observers,this._inheritingObservers=!0)}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();const t=this.query.toString();return u(t)||(e+=`${e.indexOf("?")>-1?"&":"?"}${t}`),e}get query(){return this._query}toUrl(){return this._url}execute(e){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");return setTimeout(async()=>{const t=s();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",0);const i={...e,headers:{...e.headers,"X-PnPjs-RequestId":t}};let[r,o,s]=await this.emit.pre(this.toRequestUrl(),i,void 0);if(a(`Url: ${r}`,1),void 0!==s)return a("Result returned from pre, Emitting data"),this.emit.data(s),void a("Emitted data");a("Emitting auth"),[n,o]=await this.emit.auth(new URL(r),o),a("Emitted auth"),o={...o,...e,headers:{...o.headers,...e.headers}},a("Emitting send");let c=await this.emit.send(n,o);a("Emitted send"),a("Emitting parse"),[n,c,s]=await this.emit.parse(n,c,s),a("Emitted parse"),a("Emitting post"),[n,s]=await this.emit.post(n,s),a("Emitted post"),a("Emitting data"),this.emit.data(s),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",0)}},0),this.emit[this.InternalPromise](new Promise((e,t)=>{this.on[this.InternalResolve].replace(e),this.on[this.InternalReject].replace(t)}))[0]}};function T(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function U(e){return this.start(T("GET",e))}function F(e){return this.start(T("POST",e))}function H(e){return this.start(T("PATCH",e))}function R(e){return this.start(T("DELETE",e))}function N(e,t,n){return Reflect.apply(t,e,[n])}function B(e){return t=>new Proxy(t,{construct(t,n,a){const i=Object.assign(function(t){return c(e)||(e=function(e){return N(this,U,e)}),Reflect.apply(e,i,[t])},Reflect.construct(t,n,a));return Reflect.setPrototypeOf(i,a.prototype),i}})}function j(){return W(e=>e.text())}function V(){return W(e=>e.json())}function z(){return W(e=>c(e.arrayBuffer)?e.arrayBuffer():e.buffer())}async function G(e,t,n){if(!t.ok)throw await q.init(t);return[e,t,n]}function K(e){let t=e;return m(e,"d")?t=m(e.d,"results")?e.d.results:e.d:m(e,"value")&&(t=e.value),t}function W(e){return t=>(t.on.parse.replace(G),t.on.parse(async(t,n,a)=>(n.ok&&void 0===a&&(a=await e(n)),[t,n,a])),t)}P=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([B()],P);class q extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.clone().text();return new q(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e)}}new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new b("undefined"==typeof localStorage?h():localStorage)),this._local}get session(){return null===this._session&&(this._session=new b("undefined"==typeof sessionStorage?h():sessionStorage)),this._session}};const Q="__CancelMoment__",Y=Symbol.for("CancelScopeId"),J=new Map;async function X(e){const t=J.get(e);t.controller.abort(),d(null==t?void 0:t.actions)&&t.actions.map(e=>t.currentSelf.on[Q](e));try{await t.currentSelf.emit[Q]()}catch(e){t.currentSelf.log(`Error in cancel: ${e}`,3)}}const Z=e=>function(...t){Reflect.has(this,Y)||function(e){const t=s();e[Y]=t,J.set(t,{cancel:X.bind({},t),actions:[],controller:null,currentSelf:e})}(this);const n=e.apply(this,t).finally(()=>{J.delete(this[Y]),delete this[Y]});return n.cancel=J.get(this[Y]).cancel,n};function $(e,t,n){n.value=Z(n.value)}function ee(e){return t=>(t.on.pre(async function(...t){const n=J.get(this[Y]);return f(n)&&(d(n.actions)||(n.actions=[]),n.actions.indexOf(e)<0&&n.actions.push(e)),t}),t)}function te(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function ne(e,t){return Object.assign({body:p(e)},t)}function ae(e,t){return Object.assign({},t,{headers:{...null==t?void 0:t.headers,...e}})}const ie=e=>{return t=e,(e,n)=>{const a=new t(e,n);return a.emit.construct(e,n),a};var t};class re extends P{constructor(e,t){if("string"==typeof e){let n="",a="";if(l(e)||e.lastIndexOf("/")<0)a=e,n=i(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const r=e.lastIndexOf("/");a=e.slice(0,r),t=i(e.slice(r),t),n=i(a,t)}else{const r=e.lastIndexOf("(");a=e.slice(0,r),n=i(e,t)}super(n),this.parentUrl=a}else{super(e,t);const n=d(e)?e[0]:e;this.parentUrl=d(e)?e[1]:n.toUrl()}}toRequestUrl(){const e=new URLSearchParams(this.query);let t=this.toUrl().replace(/'!(@.+?)::((?:[^']|'')+)'/gi,(t,n,a)=>(this.log(`Rewriting aliased parameter from match ${t} to label: ${n} value: ${a}`,0),e.set(n,`'${a}'`),n));const n=e.toString();return u(n)||(t+=`${t.indexOf("?")>-1?"&":"?"}${n}`),t}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t,n=this.parentUrl){return e([this,n],t)}}const oe=ie(re);class se extends re{filter(e){return"object"==typeof e?(this.query.set("$filter",e.toString()),this):"function"==typeof e?(this.query.set("$filter",e(De.Where()).toString()),this):(this.query.set("$filter",e.toString()),this)}orderBy(e,t=!0){const n="$orderby",a=this.query.has(n)?this.query.get(n).split(","):[];return a.push(`${e} ${t?"asc":"desc"}`),this.query.set(n,a.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const ce=ie(se);class de extends re{}const le=ie(de);function ue(){return function(){return he(this)}}function fe(){return function(e="*"){return be(this,{},e)}}const pe=(e,t)=>N(e,U,t),me=(e,t)=>N(e,F,t),_e=(e,t)=>((t=t||{}).headers={...t.headers,"X-HTTP-Method":"MERGE"},me(e,t)),he=(e,t)=>((t=t||{}).headers={...t.headers||{},"X-HTTP-Method":"DELETE"},me(e,t)),be=(e,t,n="*")=>((t=t||{}).headers={...t.headers||{},"IF-Match":n},he(e,t)),ge=(e,t)=>N(e,R,t),ve=(e,t)=>N(e,H,t);var ye,Se;!function(e){e.Equals="eq",e.NotEquals="ne",e.GreaterThan="gt",e.GreaterThanOrEqualTo="ge",e.LessThan="lt",e.LessThanOrEqualTo="le",e.StartsWith="startswith",e.SubstringOf="substringof"}(ye||(ye={})),function(e){e.And="and",e.AndWithSpace=" and ",e.Or="or",e.OrWithSpace=" or "}(Se||(Se={}));class De{static Where(){return new we([])}}class Ie{constructor(e){this.query=[],this.query=e}}class xe extends Ie{constructor(e){super(e)}text(e){return new ke([...this.query,e])}choice(e){return new ke([...this.query,e])}multiChoice(e){return new ke([...this.query,e])}number(e){return new Te([...this.query,e])}date(e){return new Ue([...this.query,e])}boolean(e){return new Me([...this.query,e])}lookup(e){return new Ee([...this.query],e)}lookupId(e){const t=e.endsWith("Id")?e:`${e}Id`;return new Te([...this.query,t])}}class Ce extends xe{or(...e){return new Fe([...this.query,`(${e.map(e=>e.toString()).join(Se.OrWithSpace)})`])}}class Oe extends xe{and(...e){return new Fe([...this.query,`(${e.map(e=>e.toString()).join(Se.AndWithSpace)})`])}}class we extends xe{or(...e){return null==e||0===e.length?new xe([...this.query,Se.Or]):new Fe([...this.query,`(${e.map(e=>e.toString()).join(Se.OrWithSpace)})`])}and(...e){return null==e||0===e.length?new xe([...this.query,Se.And]):new Fe([...this.query,`(${e.map(e=>e.toString()).join(Se.AndWithSpace)})`])}}class Ee extends Ie{constructor(e,t){super(e),this.LookupField=t}Id(e){return new Fe([...this.query,`${this.LookupField}/Id`,ye.Equals,e.toString()])}text(e){return new ke([...this.query,`${this.LookupField}/${e}`])}number(e){return new Te([...this.query,`${this.LookupField}/${e}`])}}class Ae extends Ie{constructor(e){super(e),this.LastIndex=e.length-1,this.InternalName=e[this.LastIndex]}toODataValue(e){return`'${e}'`}isNull(){return new Fe([...this.query,ye.Equals,"null"])}isNotNull(){return new Fe([...this.query,ye.NotEquals,"null"])}}class Le extends Ae{equals(e){return new Fe([...this.query,ye.Equals,this.toODataValue(e)])}notEquals(e){return new Fe([...this.query,ye.NotEquals,this.toODataValue(e)])}in(...e){return De.Where().or(...e.map(e=>this.equals(e)))}notIn(...e){return De.Where().and(...e.map(e=>this.notEquals(e)))}}class ke extends Le{startsWith(e){const t=`${ye.StartsWith}(${this.InternalName}, ${this.toODataValue(e)})`;return this.query[this.LastIndex]=t,new Fe([...this.query])}contains(e){const t=`${ye.SubstringOf}(${this.toODataValue(e)}, ${this.InternalName})`;return this.query[this.LastIndex]=t,new Fe([...this.query])}}class Me extends Ae{toODataValue(e){return`${null==e?"null":e?1:0}`}isTrue(){return new Fe([...this.query,ye.Equals,this.toODataValue(!0)])}isFalse(){return new Fe([...this.query,ye.Equals,this.toODataValue(!1)])}isFalseOrNull(){const e=`(${[this.InternalName,ye.Equals,this.toODataValue(null),Se.Or,this.InternalName,ye.Equals,this.toODataValue(!1)].join(" ")})`;return this.query[this.LastIndex]=e,new Fe([...this.query])}}class Pe extends Le{greaterThan(e){return new Fe([...this.query,ye.GreaterThan,this.toODataValue(e)])}greaterThanOrEquals(e){return new Fe([...this.query,ye.GreaterThanOrEqualTo,this.toODataValue(e)])}lessThan(e){return new Fe([...this.query,ye.LessThan,this.toODataValue(e)])}lessThanOrEquals(e){return new Fe([...this.query,ye.LessThanOrEqualTo,this.toODataValue(e)])}}class Te extends Pe{toODataValue(e){return`${e}`}}class Ue extends Pe{toODataValue(e){return`'${e.toISOString()}'`}isBetween(e,t){const n=`(${[this.InternalName,ye.GreaterThan,this.toODataValue(e),Se.And,this.InternalName,ye.LessThan,this.toODataValue(t)].join(" ")})`;return this.query[this.LastIndex]=n,new Fe([...this.query])}isToday(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;return t.setHours(23,59,59,999),this.isBetween(e,t)}}class Fe extends Ie{and(...e){return null==e||0===e.length?new Ce([...this.query,Se.And]):new Fe([...this.query,Se.And,`(${e.map(e=>e.toString()).join(Se.AndWithSpace)})`])}or(...e){return null==e||0===e.length?new Oe([...this.query,Se.Or]):new Fe([...this.query,Se.Or,`(${e.map(e=>e.toString()).join(Se.OrWithSpace)})`])}toString(){return this.query.join(" ")}}class He{constructor(e=""){this._root=oe(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}function Re(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new He(e)}const Ne="00000000-0000-0000-0000-000000000000";var Be,je,Ve;function ze(e){if(u(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substring(0,t):e}function Ge(e){const t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(m(e,n[0])&&"SP.Web"===e[n[0]])m(e,n[4])?t.push(e[n[4]]):m(e,n[2])&&t.push(e.__metadata.uri);else if(m(e,n[3])&&m(e,n[1])){const a=l(e[n[1]])?e[n[1]].split("_api")[1]:e[n[1]];t.push(ze(e[n[3]]),"_api",a)}else m(e,n[1])?t.push("_api",e[n[1]]):m(e,n[2])&&t.push(e.__metadata.uri);return t.length<1?"":i(...t)}function Ke(e){return u(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${n.replace(/'/gi,"''")}`):encodeURIComponent(e.replace(/'/gi,"''"))}function We(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function qe(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(Be||(Be={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(je||(je={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(Ve||(Ve={})),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let Qe=class extends se{async add(e,t,n="",a="STS",i=1033,r=!0){const o=ne({parameters:{Description:n,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:r,WebTemplate:a}});return me(Ye(this,"add"),o)}};Qe=We([qe("webs")],Qe);const Ye=ie(Qe);function Je(e,t){let n="_api/web";const a=/(_api[/|\\](site\/rootweb|site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=ze(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=i(e,n)),e}let Xe=class extends de{constructor(e,t){super(e="string"==typeof e?Je(e,t):d(e)?[e[0],Je(e[1],t)]:[e,Je(e.toUrl(),t)],t),this.delete=ue()}get webs(){return Ye(this)}get allProperties(){return le(this,"allproperties")}get webinfos(){return ce(this,"webinfos")}async getParentWeb(){const{Url:e,ParentWeb:t}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return(null==t?void 0:t.ServerRelativeUrl)?Ze([this,i(new URL(e).origin,t.ServerRelativeUrl)]):null}async update(e){return _e(this,ne(e))}applyTheme(e,t,n,a){const i=ne({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:a});return me(Ze(this,"applytheme"),i)}applyWebTemplate(e){return me(Ze(this,`applywebtemplate(webTemplate='${Ke(e)}')`))}getChanges(e){return me(Ze(this,"getchanges"),ne({query:e}))}mapToIcon(e,t=0,n=""){return Ze(this,`maptoicon(filename='${Ke(e)}',progid='${Ke(n)}',size=${t})`)()}getStorageEntity(e){return Ze(this,`getStorageEntity('${Ke(e)}')`)()}setStorageEntity(e,t,n="",a=""){return me(Ze(this,"setStorageEntity"),ne({comments:a,description:n,key:e,value:t}))}removeStorageEntity(e){return me(Ze(this,`removeStorageEntity('${Ke(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return ce(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}availableWebTemplates(e=1033,t=!0){return ce(this,`getavailablewebtemplates(lcid=${e},doincludecrosslanguage=${t})`)}};Xe=We([qe("_api/web")],Xe);const Ze=ie(Xe);He.prototype.batched=function(e){const t=Re(this),[n,a]=nt(t._root,e);return t.using(n),[t,a]},Xe.prototype.batched=function(e){const t=Ze(this),[n,a]=nt(t,e);return t.using(n),[t,a]};const $e=Symbol.for("batch_registration"),et=Symbol.for("batch_request");class tt extends re{constructor(e,t=e.toUrl().replace(/_api[\\|/].*$/i,"")){super(t,"_api/$batch"),this.requestBaseUrl=t,this.using(L(e,"replace"),W(async e=>function(e){const t=[],n="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let r,o,s="batch",c={};const d=[];for(let e=0;e<i.length;++e){let l=i[e];switch(s){case"batch":if(l.substring(0,16)===n)s="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(s="status");break;case"status":{const t=a.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);r=parseInt(t[1],10),o=t[2],s="statusHeaders";break}case"statusHeaders":if(""===l.trim())s="body";else{const e=l.split(":");2===(null==e?void 0:e.length)&&(c[e[0].trim()]=e[1].trim())}break;case"body":for(d.length=0;l.substring(0,16)!==n;)d.push(l),l=i[++e];e--,t.push(new Response(204===r?null:d.join(""),{status:r,statusText:o,headers:c})),s="batch",c={}}}if("status"!==s)throw Error("Unexpected end of input");return t}(await e.text()))),this.on.dispose(()=>{e.using(L(this,"replace",e=>/(auth|send|pre|init)/i.test(e)))})}}function nt(e,t){const n=[],a=[],r=[],o=new tt(e),d=s(),u=new tt(e),{headersCopyPattern:f,maxRequests:p}={headersCopyPattern:/Accept|Content-Type|IF-Match/i,maxRequests:20,...t};return[e=>(e.on.init(function(){if(c(this[$e]))throw Error("This instance is already part of a batch. Please review the docs at https://pnp.github.io/pnpjs/concepts/batching#reuse.");return n.push(new Promise(e=>{this[$e]=e})),this}),e.on.pre(async function(e,t,n){return m(t.headers,"X-PnP-BatchNever")?("function"==typeof this[et]&&(this[et](),delete this[et]),this.using(L(u,"replace",e=>/(init|pre)/i.test(e))),[e,t,n]):(this.on.auth.clear(),this.on.send.replace(async function(e,t){const n=new Promise(n=>{r.push([this,e.toString(),t,n])});return this.log(`[batch:${d}] (${(new Date).getTime()}) Adding request ${t.method} ${e.toString()} to batch.`,0),a.push(new Promise(e=>{this[et]=e})),this[$e](),n}),this.on.dispose(function(){c(this[$e])&&(this[$e](),delete this[$e]),c(this[et])&&(this[et](),delete this[et],this.using(L(u,"replace",e=>/(auth|pre|send|init|dispose)/i.test(e))))}),[e,t,n])}),e),async()=>{if(await Promise.all(n),r.length<1)return Promise.all(a).then(()=>{});const e=r.slice();for(;e.length>0;){const t=e.splice(0,p),n=[];let a="";for(let e=0;e<t.length;e++){const[,r,c]=t[e];"GET"===c.method?(a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${d}\n`)):(a.length<1&&(a=s(),n.push(`--batch_${d}\n`),n.push(`Content-Type: multipart/mixed; boundary="changeset_${a}"\n\n`)),n.push(`--changeset_${a}\n`)),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");const u=new Headers(c.headers),p=l(r)?r:i(o.requestBaseUrl,r);if("GET"!==c.method){let e=c.method;u.has("X-HTTP-Method")&&(e=u.get("X-HTTP-Method"),u.delete("X-HTTP-Method")),n.push(`${e} ${p} HTTP/1.1\n`)}else n.push(`${c.method} ${p} HTTP/1.1\n`);u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;charset=utf-8"),u.forEach((e,t)=>{f.test(t)&&n.push(`${t}: ${e}\n`)}),n.push("\n"),c.body&&n.push(`${c.body}\n\n`)}a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${d}--\n`);const r=await me(o,{body:n.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${d}`}});if(r.length!==t.length)throw Error("Could not properly parse responses to match requests in batch.");for(let e=0;e<r.length;e++)t[e][3](r[e])}await Promise.all(a).then(()=>{})}]}function at(e){const t=new Date;return!f(e)||t>e.expiration?null:e}const it=new Map;class rt extends Error{constructor(e){super(`SPFx Context supplied to ${e} Behavior is null or undefined.`)}static check(e,t){if(null==t)throw new rt(e)}}function ot(e,t){const n=["_api/web/tenantappcatalog/","_api/web/sitecollectionappcatalog/"];for(let a=0;a<n.length;a++){const r=e.indexOf(n[a]);if(r>-1)return i(e.substring(r,r+n[a].length),t)}return i(e,t)}let st=class extends se{constructor(e,t){super(e,null),this._url=i(ze(this._url),t)}getAppById(e){return dt(this,`getById('${e}')`)}async syncSolutionToTeams(e,t=!1){let n=null;const a=i(ze(this.toUrl()),"_api/web");if(t)n=e;else{const t=(await ce([this,a],"lists").select("Id").filter("EntityTypeName eq 'AppCatalog'")())[0].Id,i=await ce([this,a],`lists/getById('${t}')/items`).select("Id").filter(`AppProductID eq '${e}'`).top(1)();if(!(i&&i.length>0))throw Error(`Did not find the app with id ${e} in the appcatalog.`);n=i[0].Id}return me(ct(this,ot(this.toUrl(),`SyncSolutionToTeams(id=${n})`)))}async add(e,t,n=!0){const a=ct(this,ot(this.toUrl(),`add(overwrite=${n},url='${e}')`));return me(a,{body:t,headers:{binaryStringRequestBody:"true"}})}};st=We([qe("_api/web/tenantappcatalog/AvailableApps")],st);const ct=ie(st),dt=ie(class extends de{deploy(e=!1){return this.do(`Deploy(${e})`)}retract(){return this.do("Retract")}install(){return this.do("Install")}uninstall(){return this.do("Uninstall")}upgrade(){return this.do("Upgrade")}remove(){return this.do("Remove")}do(e){return me(dt(this,e))}});function lt(e){return{DecodedUrl:e}}te(Xe,"appcatalog",e=>ct(e,"_api/web/sitecollectionappcatalog/AvailableApps")),Reflect.defineProperty(He.prototype,"tenantAppcatalog",{configurable:!0,enumerable:!0,get:function(){return this.create(ct,"_api/web/tenantappcatalog/AvailableApps")}}),He.prototype.getTenantAppCatalogWeb=async function(){const e=await Ze(this._root,"_api/SP_TenantSettings_Current")();return Ze([this._root,e.CorporateCatalogUrl])};let ut=class extends se{getById(e){return mt(this).concat(`('${e}')`)}getByTitle(e){return mt(this,`getByTitle('${Ke(e)}')`)}async add(e,t="",n=100,a=!1,i={}){const r={AllowContentTypes:a,BaseTemplate:n,ContentTypesEnabled:a,Description:t,Title:e,...i};return me(this,ne(r))}async ensure(e,t="",n=100,a=!1,i={}){const r={Title:e,Description:t,ContentTypesEnabled:a,...i},o=this.getByTitle(r.Title);try{return await o.select("Title")(),{created:!1,data:await o.update(r),list:this.getByTitle(r.Title)}}catch(i){return{created:!0,data:await this.add(e,t,n,a,r),list:this.getByTitle(r.Title)}}}async ensureSiteAssetsLibrary(){const e=await me(ft(this,"ensuresiteassetslibrary"));return mt([this,Ge(e)])}async ensureSitePagesLibrary(){const e=await me(ft(this,"ensuresitepageslibrary"));return mt([this,Ge(e)])}};ut=We([qe("lists")],ut);const ft=ie(ut);class pt extends de{constructor(){super(...arguments),this.delete=fe()}get effectiveBasePermissions(){return oe(this,"EffectiveBasePermissions")}get eventReceivers(){return ce(this,"EventReceivers")}get relatedFields(){return oe(this,"getRelatedFields")}get informationRightsManagementSettings(){return oe(this,"InformationRightsManagementSettings")}async update(e,t="*"){return await _e(this,ne(e,ae({"IF-Match":t})))}getChanges(e){return me(mt(this,"getchanges"),ne({query:e}))}getItemsByCAMLQuery(e,...t){return me(mt(this,"getitems").expand(...t),ne({query:e}))}getListItemChangesSinceToken(e){return me(mt(this,"getlistitemchangessincetoken").using(j()),ne({query:e}))}async recycle(){return me(mt(this,"recycle"))}async renderListData(e){const t=mt(this,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const n=await me(t);return JSON.parse(n)}renderListDataAsStream(e,t=null,n=new Map){m(e,"RenderOptions")&&d(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));const a=mt(this,"RenderListDataAsStream");n&&n.size>0&&n.forEach((e,t)=>a.query.set(t,e));const i=f(t)?{parameters:e,overrideParameters:t}:{parameters:e};return me(a,ne(i))}async renderListFormData(e,t,n){const a=await me(mt(this,`renderlistformdata(itemid=${e}, formid='${t}', mode='${n}')`));return JSON.parse(a)}async reserveListItemId(){return me(mt(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(e,t,n=!1,a,i){const r={FolderPath:lt(t)};return f(i)&&(i.leafName&&(r.LeafName=lt(i.leafName)),i.objectType&&(r.UnderlyingObjectType=i.objectType)),me(mt(this,"AddValidateUpdateItemUsingPath()"),ne({bNewDocumentUpdate:n,checkInComment:a,formValues:e,listItemCreateInfo:r}))}async getParentInfos(){const e=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}}const mt=ie(pt);var _t,ht;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest",e[e.ListAvailableContentTypes=65536]="ListAvailableContentTypes",e[e.FolderContentTypeOrder=131072]="FolderContentTypeOrder",e[e.GridInitInfo=262144]="GridInitInfo",e[e.SiteUrlAsMediaTASPItemHost=524288]="SiteUrlAsMediaTASPItemHost",e[e.AddToOneDrive=1048576]="AddToOneDrive",e[e.SPFXCustomActions=2097152]="SPFXCustomActions",e[e.CustomActions=4194304]="CustomActions"}(_t||(_t={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(ht||(ht={}));let bt=class extends se{getById(e){return yt(this).concat(`(${e})`)}getItemByStringId(e){return yt([this,this.parentUrl],`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`):this.query.set("$skiptoken",`Paged=TRUE&p_ID=${e}`),this}[Symbol.asyncIterator](){const e=ce(this).using(W(async e=>{const t=await e.json(),n=m(t,"d")&&m(t.d,"__next")?t.d.__next:t["odata.nextLink"];return{hasNext:"string"==typeof n&&n.length>0,nextLink:n,value:K(t)}})),t=["$top","$select","$expand","$filter","$orderby","$skiptoken"];for(let n=0;n<t.length;n++){const a=this.query.get(t[n]);f(a)&&e.query.set(t[n],a)}return{_next:e,async next(){if(null===this._next)return{done:!0,value:void 0};const e=await this._next();return e.hasNext?(this._next=ce([this._next,e.nextLink]),{done:!1,value:e.value}):(this._next=null,{done:!1,value:e.value})}}}async add(e={}){return me(this,ne(e))}};bt=We([qe("items")],bt);const gt=ie(bt);class vt extends de{constructor(){super(...arguments),this.delete=fe()}get effectiveBasePermissions(){return oe(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return oe(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return le(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return le(this,"FieldValuesAsText")}get fieldValuesForEdit(){return le(this,"FieldValuesForEdit")}get versions(){return Dt(this)}get list(){return this.getParent(mt,"",this.parentUrl.substring(0,this.parentUrl.lastIndexOf("/")))}async update(e,t="*"){const n=ne(e,ae({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return me(yt(this).using(W(async e=>({etag:e.headers.get("etag")}))),n)}recycle(){return me(yt(this,"recycle"))}async deleteWithParams(e){return me(yt(this,"DeleteWithParameters"),ne({parameters:e}))}async getWopiFrameUrl(e=0){const t=yt(this,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),me(t)}validateUpdateListItem(e,t=!1){return me(yt(this,"validateupdatelistitem"),ne({formValues:e,bNewDocumentUpdate:t}))}async getParentInfos(){const e=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,Title:e.ParentList.Title,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}async setImageField(e,t,n){const a=await this.getParentInfos(),i=ze(this.toUrl()),r=oe([this,i],"/_api/web/UploadImage");r.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),r.query.set("@a1",`'${a.ParentList.Title}'`),r.query.set("@a2",`'${t}'`),r.query.set("@a3",`'${a.ParentList.Id}'`),r.query.set("@a4",a.Item.Id);const o=await me(r,{body:n}),s={type:"thumbnail",fileName:o.Name,nativeFile:{},fieldName:e,serverUrl:a.ParentWeb.Url.replace(a.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:o.ServerRelativeUrl,id:o.UniqueId};return this.validateUpdateListItem([{FieldName:e,FieldValue:JSON.stringify(s)}])}}const yt=ie(vt);let St=class extends se{getById(e){return It(this).concat(`(${e})`)}};St=We([qe("versions")],St);const Dt=ie(St),It=ie(class extends de{constructor(){super(...arguments),this.delete=fe()}});class xt extends de{getText(){return this.getParsed(j())}getBlob(){return this.getParsed(W(e=>e.blob()))}getBuffer(){return this.getParsed(z())}getJSON(){return this.getParsed(V())}getStream(){return oe(this,"$value").using(W(async e=>{var t;return{body:e.body,knownLength:parseInt((null===(t=null==e?void 0:e.headers)||void 0===t?void 0:t.get("content-length"))||"-1",10)}}),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheNever":"1"},[e,t,n]}),e))(ae({binaryStringResponseBody:"true"}))}getParsed(e){return oe(this,"$value").using(e,e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheNever":"1"},[e,t,n]}),e))()}}let Ct=class extends se{getByName(e){const t=wt(this);return t.concat(`('${Ke(e)}')`),t}async add(e,t){return{data:await me(Ot(this,`add(FileName='${Ke(e)}')`),{body:t}),file:this.getByName(e)}}};Ct=We([qe("AttachmentFiles")],Ct);const Ot=ie(Ct),wt=ie(class extends xt{constructor(){super(...arguments),this.delete=fe()}async setContent(e){return await me(wt(this,"$value"),ae({"X-HTTP-Method":"PUT"},{body:e})),this}recycle(e="*"){return me(wt(this,"recycleObject"),ae({"IF-Match":e,"X-HTTP-Method":"DELETE"}))}});function Et(e,t){let n="_api/site";const a=/(_api[/|\\](site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=ze(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=i(e,n)),e}te(vt,"attachmentFiles",Ot);let At=class extends de{constructor(e,t){super(e="string"==typeof e?Et(e,t):d(e)?[e[0],Et(e[1],t)]:[e,Et(e.toUrl(),t)],t)}get rootWeb(){return Ze(this,"rootweb")}getChanges(e){const t=ne({query:e});return me(Ze(this,"getchanges"),t)}async openWebById(e){const t=await me(Lt(this,`openWebById('${e}')`));return{data:t,web:Ze([this,ze(Ge(t))])}}async getRootWeb(){const e=await this.rootWeb.select("Url")();return Ze([this,e.Url])}async delete(){const e=await Lt(this,"").select("Id")(),t=Lt([this,this.parentUrl],"_api/SPSiteManager/Delete");await me(t,ne({siteId:e.Id}))}async getDocumentLibraries(e){const t=Lt([this,this.parentUrl],"_api/sp.web.getdocumentlibraries(@v)");t.query.set("@v",`'${e}'`);const n=await t();return m(n,"GetDocumentLibraries")?n.GetDocumentLibraries:n}async getWebUrlFromPageUrl(e){const t=Lt([this,this.parentUrl],"_api/sp.web.getweburlfrompageurl(@v)");t.query.set("@v",`'${e}'`);const n=await t();return m(n,"GetWebUrlFromPageUrl")?n.GetWebUrlFromPageUrl:n}async createCommunicationSite(e,t=1033,n=!1,a,i,r,o,s,c){return this.createCommunicationSiteFromProps({Classification:r,Description:i,HubSiteId:s,Lcid:t,Owner:c,ShareByEmailEnabled:n,SiteDesignId:o,Title:e,Url:a})}async createCommunicationSiteFromProps(e){const t={Classification:"",Description:"",HubSiteId:Ne,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:Ne,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:Ne,...e};return me(Lt([this,ze(this.toUrl())],"/_api/SPSiteManager/Create"),ne({request:t}))}async exists(e){return me(Lt([this,ze(this.toUrl())],"/_api/SP.Site.Exists"),ne({url:e}))}async createModernTeamSite(e,t,n,a,i,r,o,s,c){return this.createModernTeamSiteFromProps({alias:t,classification:r,description:i,displayName:e,hubSiteId:s,isPublic:n,lcid:a,owners:o,siteDesignId:c})}async createModernTeamSiteFromProps(e){const t=Object.assign({},{classification:"",description:"",hubSiteId:Ne,isPublic:!0,lcid:1033,owners:[]},e),n={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:[`SPSiteLanguage:${t.lcid}`,`HubSiteId:${t.hubSiteId}`],Description:t.description,Owners:t.owners}};return t.siteDesignId&&n.optionalParams.CreationOptions.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${t.siteDesignId}`),me(Lt([this,ze(this.toUrl())],"/_api/GroupSiteManager/CreateGroupEx").using(j()),ne(n))}update(e){return ve(this,ne(e))}setSiteLogo(e){return me(oe([this,ze(this.toUrl())],"_api/siteiconmanager/setsitelogo"),ne(e))}};At=We([qe("_api/site")],At);const Lt=ie(At);var kt,Mt;function Pt(e){return e.length<1?1:Math.max.apply(null,e.map(e=>e.order))+1}function Tt(e){for(let t=0;t<e.length;t++)e[t].order=t+1,m(e[t],"columns")?Tt(e[t].columns):m(e[t],"controls")&&Tt(e[t].controls)}!function(e){e[e.WebLogo=0]="WebLogo",e[e.HubLogo=1]="HubLogo",e[e.HeaderBackground=2]="HeaderBackground",e[e.GlobalNavLogo=3]="GlobalNavLogo"}(kt||(kt={})),function(e){e[e.Square=0]="Square",e[e.Rectangular=1]="Rectangular"}(Mt||(Mt={})),te(pt,"items",gt),re.prototype.getContextInfo=async function(e=this.parentUrl){const t=await me(oe([this,ze(e)],"_api/contextinfo"));if(m(t,"GetContextWebInformation")){const e=t.GetContextWebInformation;return e.SupportedSchemaVersions=e.SupportedSchemaVersions.results,e}return t};let Ut=class extends se{getByUrl(e){if(/%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return Rt(this).concat(`('${Ke(e)}')`)}async addUsingPath(e,t,n={Overwrite:!1}){const a=[`AddUsingPath(decodedurl='${Ke(e)}'`];return n&&(n.Overwrite&&a.push(",Overwrite=true"),n.EnsureUniqueFileName&&a.push(`,EnsureUniqueFileName=${n.EnsureUniqueFileName}`),n.AutoCheckoutOnInvalidData&&a.push(",AutoCheckoutOnInvalidData=true"),u(n.XorHash)||a.push(`,XorHash=${Ke(n.XorHash)}`)),a.push(")"),me(Ft(this,a.join("")),{body:t})}async addChunked(e,t,n){const a=Nt(this,(await this.addUsingPath(e,null,n)).ServerRelativeUrl);return a.using(ee(()=>Rt(a).delete())),a.setContentChunked(t,n)}async addTemplateFile(e,t){return me(Ft(this,`addTemplateFile(urloffile='${Ke(e)}',templatefiletype=${t})`))}};We([$],Ut.prototype,"addUsingPath",null),We([$],Ut.prototype,"addChunked",null),We([$],Ut.prototype,"addTemplateFile",null),Ut=We([qe("files")],Ut);const Ft=ie(Ut);class Ht extends xt{constructor(){super(...arguments),this.delete=fe()}get listItemAllFields(){return le(this,"listItemAllFields")}get versions(){return Vt(this)}async getLockedByUser(){const e=await pe(Rt(this,"lockedByUser"));return!0===e["odata.null"]?null:e}approve(e=""){return me(Rt(this,`approve(comment='${Ke(e)}')`))}cancelUpload(e){return me(Rt(this,`cancelUpload(uploadId=guid'${e}')`))}checkin(e="",t=Gt.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return me(Rt(this,`checkin(comment='${Ke(e)}',checkintype=${t})`))}checkout(){return me(Rt(this,"checkout"))}copyTo(e,t=!0){return me(Rt(this,`copyTo(strnewurl='${Ke(e)}',boverwrite=${t})`))}async copyByPath(e,...t){let n={ShouldBypassSharedLocks:!0,ResetAuthorAndCreatedOnCopy:!0,KeepBoth:!1};return 2===t.length&&("boolean"==typeof t[1]?n.KeepBoth=t[1]:"object"==typeof t[1]&&(n={...n,...t[1]})),this.moveCopyImpl(e,n,t[0],"CopyFileByPath")}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return me(Rt(this,`deny(comment='${Ke(e)}')`))}async moveByPath(e,...t){let n={KeepBoth:!1,ShouldBypassSharedLocks:!0,RetainEditorAndModifiedOnMove:!1};return 2===t.length&&("boolean"==typeof t[1]?n.KeepBoth=t[1]:"object"==typeof t[1]&&(n={...n,...t[1]})),this.moveCopyImpl(e,n,t[0],"MoveFileByPath")}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return me(Rt(this,`publish(comment='${Ke(e)}')`))}recycle(){return me(Rt(this,"recycle"))}async deleteWithParams(e){return me(Rt(this,"DeleteWithParameters"),ne({parameters:e}))}undoCheckout(){return me(Rt(this,"undoCheckout"))}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return me(Rt(this,`unpublish(comment='${Ke(e)}')`))}async exists(){try{return(await Rt(this).select("Exists")()).Exists}catch(e){return!1}}async setContent(e){return await me(Rt(this,"$value"),{body:e,headers:{"X-HTTP-Method":"PUT"}}),Rt(this)}async getItem(...e){const t=this.listItemAllFields,n=await t.select(...e)();return Object.assign(yt([this,Ge(n)]),n)}async setContentChunked(e,t){const{progress:n}=function(e){return{progress:()=>null,...e}}(t),a=s();let i,r=!0,o=0;const c=Rt(this).using(ee(()=>Rt(c).cancelUpload(a))),d="object"==typeof(u=l=e)&&"function"==typeof u.arrayBuffer&&"string"==typeof u.type&&"function"==typeof u.stream&&"function"==typeof u.constructor&&(/^(Blob|File)$/.test(u[qt])||/^(Blob|File)$/.test(u.constructor.name))?l.stream():function(e){return"function"==typeof e.on}(l)?new ReadableStream({start(e){l.on("data",t=>{e.enqueue(t)}),l.on("end",()=>{e.close()})}}):function(e){return"object"==typeof e&&"number"==typeof e.length}(l)?new ReadableStream({start(e){e.enqueue(l),e.close()}}):function(e){return"object"==typeof e&&"object"==typeof e.readable}(l)?l.readable:l;var l,u;const f=d.getReader();for(;i=await f.read();){if(i.done)return n({offset:o,stage:"finishing",uploadId:a}),me(Rt(c,`finishUpload(uploadId=guid'${a}',fileOffset=${o})`),{body:(null==i?void 0:i.value)||""});r?(n({offset:o,stage:"starting",uploadId:a}),o=await me(Rt(c,`startUpload(uploadId=guid'${a}')`),{body:i.value}),r=!1):(n({offset:o,stage:"continue",uploadId:a}),o=await me(Rt(c,`continueUpload(uploadId=guid'${a}',fileOffset=${o})`),{body:i.value}))}}moveCopyImpl(e,t,n,a){const r=Rt(this);return r.on.pre(C(async(r,o,s)=>{const{ServerRelativeUrl:c,"odata.id":d}=await Rt(this).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).select("ServerRelativeUrl")(),u=new URL(ze(d));return[i(u.toString(),`/_api/SP.MoveCopyUtil.${a}(overwrite=@a1)?@a1=${n}`),o=ne({destPath:lt(l(e)?e:`${u.protocol}//${u.host}${e}`),options:t,srcPath:lt(l(c)?c:`${u.protocol}//${u.host}${c}`)},o),s]})),me(r).then(()=>async function(e,t){return(l(t)?Bt:Nt)(e,t)}(this,e))}}We([$],Ht.prototype,"copyByPath",null),We([$],Ht.prototype,"moveByPath",null),We([$],Ht.prototype,"setContentChunked",null);const Rt=ie(Ht);function Nt(e,t){return Rt([e,ze(e.toUrl())],`_api/web/getFileByServerRelativePath(decodedUrl='${Ke(t)}')`)}async function Bt(e,t){const{WebFullUrl:n}=await Rt(e).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).getContextInfo(t),{pathname:a}=new URL(t);return Nt(Rt([e,i(n,"_api/web")]),decodeURIComponent(a))}let jt=class extends se{getById(e){return zt(this).concat(`(${e})`)}deleteAll(){return me(Vt(this,"deleteAll"))}deleteById(e){return me(Vt(this,`deleteById(vid=${e})`))}recycleByID(e){return me(Vt(this,`recycleByID(vid=${e})`))}deleteByLabel(e){return me(Vt(this,`deleteByLabel(versionlabel='${Ke(e)}')`))}recycleByLabel(e){return me(Vt(this,`recycleByLabel(versionlabel='${Ke(e)}')`))}restoreByLabel(e){return me(Vt(this,`restoreByLabel(versionlabel='${Ke(e)}')`))}};jt=We([qe("versions")],jt);const Vt=ie(jt),zt=ie(class extends xt{constructor(){super(...arguments),this.delete=ue()}});var Gt,Kt,Wt;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(Gt||(Gt={})),function(e){e[e.None=0]="None",e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets",e[e.RetainEditorAndModifiedOnMove=2048]="RetainEditorAndModifiedOnMove"}(Kt||(Kt={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(Wt||(Wt={}));const qt=Symbol.toStringTag;Xe.prototype.getFileByServerRelativePath=function(e){return Nt(this,e)},Xe.prototype.getFileById=function(e){return Rt(this,`getFileById('${e}')`)},Xe.prototype.getFileByUrl=function(e){return Rt(this,`getFileByUrl('${Ke("!@p1::"+e)}')`)};let Qt=class extends se{async add(e){"string"==typeof e&&(e={text:e});const t=await me(Yt(this,null),ne(e));return Object.assign(this.getById(t.id),t)}getById(e){return Jt(this).concat(`(${e})`)}clear(){return me(Yt(this,"DeleteAll"))}};Qt=We([qe("comments")],Qt);const Yt=ie(Qt),Jt=ie(class extends de{get replies(){return Zt(this)}like(){return me(Jt(this,"Like"))}unlike(){return me(Jt(this,"Unlike"))}delete(){return ge(this)}});let Xt=class extends se{async add(e){"string"==typeof e&&(e={text:e});const t=await me(Zt(this,null),ne(e));return Object.assign(Jt([this,Ge(t)]),t)}};Xt=We([qe("replies")],Xt);const Zt=ie(Xt);var $t;te(vt,"comments",Yt),vt.prototype.getLikedBy=function(){return me(yt(this,"likedBy"))},vt.prototype.like=async function(){const e=await this.getParentInfos(),t=i(ze(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=true`;return me(oe([this,t]))},vt.prototype.unlike=async function(){const e=await this.getParentInfos(),t=i(ze(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=false`;return me(oe([this,t]))},vt.prototype.getLikedByInformation=function(){return yt(this,"likedByInformation").expand("likedby")()},vt.prototype.rate=async function(e){const t=await this.getParentInfos(),n=i(ze(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetRating(listID=@a1,itemID=@a2,rating=@a3)")+`?@a1='{${t.ParentList.Id}}'&@a2='${t.Item.Id}'&@a3=${e}`;return me(oe([this,n]))},function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}($t||($t={}));class en extends re{constructor(e,t,n,a=!1,r=[],o=!1){super(e,t),this.json=n,this.sections=r,this.commentsDisabled=o,this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,this.parentUrl="",this._url=i(ze(this._url),t),this._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},this._layoutPart=en.getDefaultLayoutPart(),void 0===n||a||this.fromJSON(n)}static getDefaultLayoutPart(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:"",enableGradientEffect:!0},reservedHeight:280,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}}get pageLayout(){return this.json.PageLayoutType}set pageLayout(e){this.json.PageLayoutType=e}get bannerImageUrl(){return this.json.BannerImageUrl}set bannerImageUrl(e){this.setBannerImage(e)}get thumbnailUrl(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl}set thumbnailUrl(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1}get topicHeader(){return f(this.json.TopicHeader)?this.json.TopicHeader:""}set topicHeader(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,u(e)&&(this.showTopicHeader=!1)}get title(){return this.json.Title}set title(e){this.json.Title=e,this._layoutPart.properties.title=e}get reservedHeight(){return this._layoutPart.reservedHeight}set reservedHeight(e){this._layoutPart.reservedHeight=e}get description(){return this.json.Description}set description(e){if(!u(e)&&e.length>255)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,m(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1}get layoutType(){return this._layoutPart.properties.layoutType}set layoutType(e){this._layoutPart.properties.layoutType=e}get headerTextAlignment(){return this._layoutPart.properties.textAlignment}set headerTextAlignment(e){this._layoutPart.properties.textAlignment=e}get showTopicHeader(){return this._layoutPart.properties.showTopicHeader}set showTopicHeader(e){this._layoutPart.properties.showTopicHeader=e}get showPublishDate(){return this._layoutPart.properties.showPublishDate}set showPublishDate(e){this._layoutPart.properties.showPublishDate=e}get hasVerticalSection(){return this.sections.findIndex(e=>2===e.layoutIndex)>-1}get authorByLine(){return d(this._layoutPart.properties.authorByline)&&this._layoutPart.properties.authorByline.length>0?this._layoutPart.properties.authorByline[0]:null}get verticalSection(){return this.hasVerticalSection?this.addVerticalSection():null}addSection(){const e=new an(this,Pt(this.sections),1);return this.sections.push(e),e}addVerticalSection(){const e=this.sections.findIndex(e=>2===e.layoutIndex);if(e>-1)return this.sections[e];const t=new an(this,Pt(this.sections),2);return this.sections.push(t),t}fromJSON(e){this.json=e;const t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&n.length>0&&(this._layoutPart=n[0]),this.setControls(t),this}async load(){const e=await this.getItem("Id","CommentsDisabled"),t=await oe(this,`_api/sitepages/pages(${e.Id})`)();return this.commentsDisabled=e.CommentsDisabled,this.fromJSON(t)}async save(e=!0){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const t="_layouts/15/getpreview.ashx";if(this._bannerImageDirty&&!this.bannerImageUrl.includes(t)){const e=this.bannerImageUrl;let n,a;const i=Ze(this),[r,o]=nt(i);i.using(r),i.getFileByServerRelativePath(e.replace(/%20/gi," ")).select("ListId","WebId","UniqueId","Name","SiteId")().then(e=>n=e),i.select("Url")().then(e=>a=e.Url),await o();const s=oe(a,t);s.query.set("guidSite",`${n.SiteId}`),s.query.set("guidWeb",`${n.WebId}`),s.query.set("guidFile",`${n.UniqueId}`),this.bannerImageUrl=s.toRequestUrl(),f(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:e},f(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:n.ListId,siteId:n.SiteId,uniqueId:n.UniqueId,webId:n.WebId},this._layoutPart.properties.webId=n.WebId,this._layoutPart.properties.siteId=n.SiteId,this._layoutPart.properties.listId=n.ListId,this._layoutPart.properties.uniqueId=n.UniqueId}this.json.IsPageCheckedOutToCurrentUser||await me(tn(this,`_api/sitepages/pages(${this.json.Id})/checkoutpage`));let n={AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader,BannerImageUrl:this.bannerImageUrl};(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty)&&(n={BannerImageUrl:this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl,...n});const a=tn(this,`_api/sitepages/pages(${this.json.Id})/savepage`);await me(a,ae({"if-match":"*"},ne(n)));let i=!0;return e&&(i=await me(tn(this,`_api/sitepages/pages(${this.json.Id})/publish`)),i&&(this.json.IsPageCheckedOutToCurrentUser=!1)),this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,await this.load(),i}async discardPageCheckout(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const e=await me(tn(this,`_api/sitepages/pages(${this.json.Id})/discardPage`));this.fromJSON(e)}async promoteToNews(){return this.promoteNewsImpl("promoteToNews")}findControlById(e){return this.findControl(t=>t.id===e)}findControl(e){for(let t=0;t<this.sections.length;t++)for(let n=0;n<this.sections[t].columns.length;n++)for(let a=0;a<this.sections[t].columns[n].controls.length;a++)if(e(this.sections[t].columns[n].controls[a]))return this.sections[t].columns[n].controls[a];return null}async copy(e,t,n,a=!0,i){const r=await nn(e,t,n,this.pageLayout,i);return this.copyTo(r,a)}async copyTo(e,t=!0){if(e.setControls(this.getControls()),this._layoutPart.properties&&(m(this._layoutPart.properties,"topicHeader")&&(e.topicHeader=this._layoutPart.properties.topicHeader),m(this._layoutPart.properties,"imageSourceType")&&(e._layoutPart.properties.imageSourceType=this._layoutPart.properties.imageSourceType),m(this._layoutPart.properties,"layoutType")&&(e._layoutPart.properties.layoutType=this._layoutPart.properties.layoutType),m(this._layoutPart.properties,"textAlignment")&&(e._layoutPart.properties.textAlignment=this._layoutPart.properties.textAlignment),m(this._layoutPart.properties,"showTopicHeader")&&(e._layoutPart.properties.showTopicHeader=this._layoutPart.properties.showTopicHeader),m(this._layoutPart.properties,"showPublishDate")&&(e._layoutPart.properties.showPublishDate=this._layoutPart.properties.showPublishDate),m(this._layoutPart.properties,"enableGradientEffect")&&(e._layoutPart.properties.enableGradientEffect=this._layoutPart.properties.enableGradientEffect)),!u(this.json.BannerImageUrl)){const t=new URL(this.json.BannerImageUrl),n=e=>e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5");if(t.searchParams.has("guidSite")&&t.searchParams.has("guidWeb")&&t.searchParams.has("guidFile")){const a=n(t.searchParams.get("guidSite")),i=n(t.searchParams.get("guidWeb")),r=n(t.searchParams.get("guidFile")),o=Lt(this);if((await o.select("Id")()).Id===a){const t=await o.openWebById(i),n=await t.web.getFileById(r).select("ServerRelativeUrl")(),a={};this._layoutPart.properties&&(m(this._layoutPart.properties,"translateX")&&(a.translateX=this._layoutPart.properties.translateX),m(this._layoutPart.properties,"translateY")&&(a.translateY=this._layoutPart.properties.translateY),m(this._layoutPart.properties,"imageSourceType")&&(a.imageSourceType=this._layoutPart.properties.imageSourceType),m(this._layoutPart.properties,"altText")&&(a.altText=this._layoutPart.properties.altText)),e.setBannerImage(n.ServerRelativeUrl,a)}}}return await e.save(t),e}setBannerImage(e,t){l(e)&&(e=e.replace(/^https?:\/\/[a-z0-9.]*?\.[a-z]{2,3}\//i,"/")),this.json.BannerImageUrl=e,this._layoutPart.serverProcessedContent={imageSources:{imageSource:e}},this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,f(t)&&(m(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),m(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),m(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),m(t,"altText")&&(this._layoutPart.properties.altText=t.altText))}async setBannerImageFromExternalUrl(e,t){const n=new URL(e),a=this.json.FileName.replace(/\.[^/.]+$/,""),i=n.pathname.split(/[\\/]/i).pop(),r=tn(this,"_api/sitepages/AddImageFromExternalUrl");r.query.set("imageFileName",`'${i}'`),r.query.set("pageName",`'${a}'`),r.query.set("externalUrl",`'${e}'`),r.select("ServerRelativeUrl");const o=await me(r);this.setBannerImage(o.ServerRelativeUrl,t)}async setAuthorById(e){const t=await ce([this,ze(this.toUrl())],"/_api/web/siteusers").filter(`Id eq ${e}`).select("LoginName")();if(t.length<1)throw Error(`Could not find user with id ${e}.`);return this.setAuthorByLoginName(t[0].LoginName)}async setAuthorByLoginName(e){const t=await ce([this,ze(this.toUrl())],"/_api/web/siteusers").filter(`LoginName eq '${e}'`).select("UserPrincipalName","Title")();if(t.length<1)throw Error(`Could not find user with login name '${e}'.`);this.json.AuthorByline=[t[0].UserPrincipalName],this._layoutPart.properties.authorByline=[t[0].UserPrincipalName],this._layoutPart.properties.authors=[{id:e,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}]}async getItem(...e){const t=tn(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),n=await me(t),a=mt([this,n["odata.id"]]).items.getById(this.json.Id),i=await a.select(...e)();return Object.assign(yt([this,Ge(i)]),i)}async recycle(){const e=await this.getItem();await e.recycle()}async delete(){const e=await this.getItem();await e.delete()}async schedulePublish(e){return me(tn(this,`_api/sitepages/pages(${this.json.Id})/SchedulePublish`),ne({sitePage:{PublishStartDate:e}}))}async saveAsTemplate(e=!0){const t=await me(tn(this,`_api/sitepages/pages(${this.json.Id})/SavePageAsTemplate`)),n=tn(this,null,t);return n.title=this.title,await n.save(e),n}share(e,t){return me(tn(this,"_api/SP.Publishing.RichSharing/SharePageByEmail"),ne({recipientEmails:e,message:t,url:this.json.AbsoluteUrl}))}getCanvasContent1(){return JSON.stringify(this.getControls())}getLayoutWebpartsContent(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)}setControls(e){if(this.sections=[],e&&e.length){for(let t=0;t<e.length;t++)switch(m(e[t],"controlType")?e[t].controlType:0){case 0:m(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new rn(e[t]));break;case 3:{const n=new cn(e[t]);this.mergePartToTree(n,n.data.position);break}case 4:{const n=e[t],a=new sn(n.innerHTML,n);this.mergePartToTree(a,a.data.position);break}}Tt(this.sections)}}getControls(){Tt(this.sections);const e=[];return this.sections.forEach(t=>{t.columns.forEach(n=>{n.controls.length<1?e.push({displayMode:n.data.displayMode,emphasis:this.getEmphasisObj(t.emphasis),position:n.data.position}):n.controls.forEach(n=>{n.data.emphasis=this.getEmphasisObj(t.emphasis),e.push(this.specialSaveHandling(n).data)})})}),e.push(this._pageSettings),e}getEmphasisObj(e){return e<1||e>3?{}:{zoneEmphasis:e}}async promoteNewsImpl(e){if(null===this.json.Id)throw Error("The id for this page is null.");return u(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3&&await this.save(!0),me(tn(this,`_api/sitepages/pages(${this.json.Id})/${e}`))}mergePartToTree(e,t){var n,a,i;let r=null,o=12,s=0,c=0,d=1;t&&(m(t,"zoneIndex")&&(c=t.zoneIndex),m(t,"sectionIndex")&&(s=t.sectionIndex),m(t,"sectionFactor")&&(o=t.sectionFactor),m(t,"layoutIndex")&&(d=t.layoutIndex));const l=null!==(i=null===(a=null===(n=e.data)||void 0===n?void 0:n.emphasis)||void 0===a?void 0:a.zoneEmphasis)&&void 0!==i?i:0,u=this.getOrCreateSection(c,d,l),f=u.columns.filter(e=>e.order===s);r=f.length<1?u.addColumn(o,d):f[0],e.column=r,r.addControl(e)}mergeColumnToTree(e){var t,n;const a=m(e.data,"position")&&m(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,i=m(e.data,"position")&&m(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,r=this.getOrCreateSection(a,i,(null===(n=null===(t=e.data)||void 0===t?void 0:t.emphasis)||void 0===n?void 0:n.zoneEmphasis)||0);e.section=r,r.columns.push(e)}getOrCreateSection(e,t,n){let a=null;const i=this.sections.filter(n=>n.order===e&&n.layoutIndex===t);return i.length<1?(a=2===t?this.addVerticalSection():this.addSection(),a.order=e,a.emphasis=n):a=i[0],a}specialSaveHandling(e){var t,n,a;if(3===e.data.controlType){const i=(null===(a=null===(n=null===(t=e.data)||void 0===t?void 0:t.webPartData)||void 0===n?void 0:n.serverProcessedContent)||void 0===a?void 0:a.searchablePlainTexts)||null;if(f(i)){const t=Object.getOwnPropertyNames(i);for(let n=0;n<t.length;n++)i[t[n]]=i[t[n]].replace(/</gi,"&lt;"),e.data.webPartData.serverProcessedContent.searchablePlainTexts=i}}return e}}const tn=(e,t,n,a=!1,i=[],r=!1)=>new en(e,t,n,a,i,r),nn=async(e,t,n,a="Article",i=0)=>{t=t.replace(/\.aspx$/i,"");const r=await me(tn(e,"_api/sitepages/pages"),ne({PageLayoutType:a,PromotedState:i})),o=tn(e,"",r);return o.title=t,await o.save(!1),o.title=n,o};class an{constructor(e,t,n,a=[],i=0){this.page=e,this.columns=a,this._emphasis=i,this._memId=s(),this._order=t,this._layoutIndex=n}get order(){return this._order}set order(e){this._order=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e}get layoutIndex(){return this._layoutIndex}set layoutIndex(e){this._layoutIndex=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e,t=this.layoutIndex){const n=new rn;return n.section=this,n.data.position.zoneIndex=this.order,n.data.position.layoutIndex=t,n.data.position.sectionFactor=e,n.order=Pt(this.columns),this.columns.push(n),n}addControl(e){return this.defaultColumn.addControl(e),this}get emphasis(){return this._emphasis}set emphasis(e){this._emphasis=e}remove(){this.page.sections=this.page.sections.filter(e=>e._memId!==this._memId),Tt(this.page.sections)}}class rn{constructor(e=JSON.parse(JSON.stringify(rn.Default)),t=[]){this.json=e,this.controls=t,this._section=null,this._memId=s()}get data(){return this.json}get section(){return this._section}set section(e){this._section=e}get order(){return this.data.position.sectionIndex}set order(e){this.data.position.sectionIndex=e;for(let t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e}get factor(){return this.data.position.sectionFactor}set factor(e){this.data.position.sectionFactor=e}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}remove(){this.section.columns=this.section.columns.filter(e=>e._memId!==this._memId),Tt(this.section.columns)}}rn.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class on{constructor(e){this.json=e}get id(){return this.json.id}get data(){return this.json}get column(){return this._column}set column(e){this._column=e,this.onColumnChange(this._column)}remove(){this.column.controls=this.column.controls.filter(e=>e.id!==this.id),Tt(this.column.controls)}setData(e){this.json=e}}class sn extends on{constructor(e,t=JSON.parse(JSON.stringify(sn.Default))){u(t.id)&&(t.id=s(),t.anchorComponentId=t.id),super(t),this.text=e}get text(){return this.data.innerHTML}set text(e){this.data.innerHTML=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Pt(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex}}sn.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class cn extends on{constructor(e=JSON.parse(JSON.stringify(cn.Default))){super(e)}static fromComponentDef(e){const t=new cn;return t.import(e),t}get title(){return this.data.webPartData.title}set title(e){this.data.webPartData.title=e}get description(){return this.data.webPartData.description}set description(e){this.data.webPartData.description=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}get height(){return this.data.reservedHeight}set height(e){this.data.reservedHeight=e}get width(){return this.data.reservedWidth}set width(e){this.data.reservedWidth=e}get dataVersion(){return this.data.webPartData.dataVersion}set dataVersion(e){this.data.webPartData.dataVersion=e}setProperties(e){return this.data.webPartData.properties={...this.data.webPartData.properties,...e},this}getProperties(){return this.data.webPartData.properties}setServerProcessedContent(e){return this.data.webPartData.serverProcessedContent={...this.data.webPartData.serverProcessedContent,...e},this}getServerProcessedContent(){return this.data.webPartData.serverProcessedContent}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Pt(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex}import(e){const t=s(),n=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),a=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:a.description.default,id:n,instanceId:t,properties:a.properties,title:a.title.default},webPartId:n}))}}cn.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},Xe.prototype.getClientsideWebParts=function(){return ce(this,"GetClientSideWebParts")()},Xe.prototype.addClientsidePage=function(e,t=e.replace(/\.[^/.]+$/,""),n,a){return nn(this,e,t,n,a)},Xe.prototype.loadClientsidePage=function(e){return(async e=>{const t=await e.getItem();return tn([e,ze(e.toUrl())],"",{Id:t.Id},!0).load()})(this.getFileByServerRelativePath(e))},Xe.prototype.addRepostPage=async function(e){const t=le([this,ze(this.toUrl())],"_api/sitepages/pages/reposts");return(await me(t,ne(e))).AbsoluteUrl},Xe.prototype.addFullPageApp=async function(e,t=e.replace(/\.[^/.]+$/,""),n,a){const i=await this.getClientsideWebParts(),r=new RegExp(`{?${n}}?`,"i"),o=i.find(e=>r.test(e.Id)),s=cn.fromComponentDef(o),c=await this.addClientsidePage(e,t,"SingleWebPartAppPage",a);return c.addSection().addColumn(12).addControl(s),c};let dn=class extends se{getByUrl(e){return fn(this).concat(`('${Ke(e)}')`)}async addUsingPath(e,t=!1){return me(ln(this,`addUsingPath(DecodedUrl='${Ke(e)}',overwrite=${t})`))}};dn=We([qe("folders")],dn);const ln=ie(dn);class un extends de{constructor(){super(...arguments),this.delete=fe()}get folders(){return ln(this)}get listItemAllFields(){return le(this,"listItemAllFields")}get parentFolder(){return fn(this,"parentFolder")}get properties(){return le(this,"properties")}get storageMetrics(){return le(this,"storagemetrics")}async update(e){return _e(this,ne(e))}recycle(){return me(fn(this,"recycle"))}async getItem(...e){const t=this.listItemAllFields,n=await t.select(...e)();if(n["odata.null"])throw Error("No associated item was found for this folder. It may be the root folder, which does not have an item.");return Object.assign(yt([this,Ge(n)]),n)}async moveByPath(e,...t){let n={KeepBoth:!1,ShouldBypassSharedLocks:!0,RetainEditorAndModifiedOnMove:!1};return 1===t.length&&("boolean"==typeof t[0]?n.KeepBoth=t[0]:"object"==typeof t[0]&&(n={...n,...t[0]})),this.moveCopyImpl(e,n,"MoveFolderByPath")}async copyByPath(e,...t){let n={ShouldBypassSharedLocks:!0,ResetAuthorAndCreatedOnCopy:!0,KeepBoth:!1};return 1===t.length&&("boolean"==typeof t[0]?n.KeepBoth=t[0]:"object"==typeof t[0]&&(n={...n,...t[0]})),this.moveCopyImpl(e,n,"CopyFolderByPath")}async deleteWithParams(e){return me(fn(this,"DeleteWithParameters"),ne({parameters:e}))}async addSubFolderUsingPath(e){return await me(fn(this,"AddSubFolderUsingPath"),ne({leafPath:lt(e)})),this.folders.getByUrl(e)}async getParentInfos(){const e=await this.select("ServerRelativeUrl","ListItemAllFields/ParentList/Id","ListItemAllFields/ParentList/RootFolder/UniqueId","ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl","ListItemAllFields/ParentList/RootFolder/ServerRelativePath","ListItemAllFields/ParentList/ParentWeb/Id","ListItemAllFields/ParentList/ParentWeb/Url","ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl","ListItemAllFields/ParentList/ParentWeb/ServerRelativePath").expand("ListItemAllFields/ParentList","ListItemAllFields/ParentList/RootFolder","ListItemAllFields/ParentList/ParentWeb")();return{Folder:{ServerRelativeUrl:e.ServerRelativeUrl},ParentList:{Id:e.ListItemAllFields.ParentList.Id,RootFolderServerRelativePath:e.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ListItemAllFields.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ListItemAllFields.ParentList.ParentWeb.Id,ServerRelativePath:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ListItemAllFields.ParentList.ParentWeb.Url}}}moveCopyImpl(e,t,n){const a=fn(this);return a.on.pre(C(async(a,r,o)=>{const{ServerRelativeUrl:s,"odata.id":c}=await fn(this).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).select("ServerRelativeUrl")(),d=new URL(ze(c));return[i(d.href,`/_api/SP.MoveCopyUtil.${n}()`),r=ne({destPath:lt(l(e)?e:i(d.origin,e)),options:t,srcPath:lt(i(d.origin,s))},r),o]})),me(a).then(()=>async function(e,t){return(l(t)?mn:pn)(e,t)}(this,e))}}We([$],un.prototype,"moveByPath",null),We([$],un.prototype,"copyByPath",null);const fn=ie(un);function pn(e,t){return fn([e,ze(e.toUrl())],`_api/web/getFolderByServerRelativePath(decodedUrl='${n=t,u(n)?"":/!(@.*?)::(.*?)/gi.test(n)?n.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${n.replace(/'/gi,"''")}`):n.replace(/'/gi,"''")}')`);var n}async function mn(e,t){const{WebFullUrl:n}=await fn(e).using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)).getContextInfo(t),{pathname:a}=new URL(t);return pn(fn([e,i(n,"_api/web")]),decodeURIComponent(a))}te(pt,"rootFolder",fn),pt.prototype.getDefaultColumnValues=async function(){const e=await this.rootFolder.select("ServerRelativePath")(),t=await this.select("ParentWeb/Url").expand("ParentWeb")(),n=i("/",e.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),a=i(t.ParentWeb.Url,`_api/web/getFileByServerRelativePath(decodedUrl='${Ke(n)}')`);let r="";try{r=await fn([this,a],"$value").using(j())()}catch(e){if(e&&e.status&&404===e.status)return[];throw e}const o=r.match(/<a.*?<\/a>/gi);return(null===o?[]:o.map(e=>e.trim())).reduce((e,t)=>{const n=/<a href="(.*?)">/gi.exec(t);if(n.length<1)return this.log(`Could not parse default column value from '${t}'`,2),null;const a=t.match(/<DefaultValue.*?<\/DefaultValue>/gi);return(null===a?[]:a.map(e=>e.trim())).map(t=>{const a=/<DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(t);a.length<1?this.log(`Could not parse default column value from '${t}'`,2):e.push({name:a[1],path:decodeURIComponent(n[1]),value:a[2]})}),e},[]).filter(e=>null!==e)},pt.prototype.setDefaultColumnValues=async function(e){const t=await ce(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")(),n={};for(let t=0;t<e.length;t++)null==n[e[t].path]?n[e[t].path]=[e[t]]:n[e[t].path].push(e[t]);const a=Object.getOwnPropertyNames(n),r=[];for(let e=0;e<a.length;e++){const i=n[a[e]],o=i.map(e=>{const n=t.findIndex(t=>t.InternalName===e.name);if(n<0)throw Error(`Field '${e.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);const a=t[n];let i="";switch(a.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(d(e.value))throw Error(`The type '${a.TypeAsString}' does not support multiple values.`);i=`${e.value}`;break;case"MultiChoice":i=d(e.value)?e.value.map(e=>`${e}`).join(";"):`${e.value}`;break;case"UserMulti":i=d(e.value)?e.value.map(e=>`${e}`).join(";#"):`${e.value}`;break;case"Taxonomy":case"TaxonomyFieldType":if(d(e.value))throw Error(`The type '${a.TypeAsString}' does not support multiple values.`);i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`;break;case"TaxonomyMulti":case"TaxonomyFieldTypeMulti":i=d(e.value)?e.value.map(e=>`${e.wssId};#${e.termName}|${e.termId}`).join(";#"):[e.value].map(e=>`${e.wssId};#${e.termName}|${e.termId}`).join(";#")}return`<DefaultValue FieldName="${e.name}">${i}</DefaultValue>`}),s=`<a href="${i[0].path.replace(/ /gi,"%20")}">${o.join("")}</a>`;r.push(s)}const o=`<MetadataDefaults>${r.join("")}</MetadataDefaults>`,s=await this.rootFolder.select("ServerRelativePath")(),c=await this.select("ParentWeb/Url").expand("ParentWeb")(),l=i("/",s.ServerRelativePath.DecodedUrl,"Forms"),u=i(c.ParentWeb.Url,"_api/web",`getFolderByServerRelativePath(decodedUrl='${Ke(l)}')`,"files");await me(fn([this,u],"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:o}),(await this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()).length<1&&await me(mt(this.eventReceivers,"add"),ne({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}}))},te(Xe,"lists",ft),te(Xe,"siteUserInfoList",mt),te(Xe,"defaultDocumentLibrary",mt),te(Xe,"customListTemplates",ce,"getcustomlisttemplates"),Xe.prototype.getList=function(e){return mt(this,`getList('${Ke(e)}')`)},Xe.prototype.getCatalog=async function(e){const t=await Ze(this,`getcatalog(${e})`).select("Id")();return mt([this,Ge(t)])},un.prototype.getDefaultColumnValues=async function(){const e=await fn(this,"Properties").select("vti_x005f_listname")(),{ServerRelativePath:t}=await this.select("ServerRelativePath")(),n=Ze([this,ze(Ge(e))]).lists.getById(e.vti_x005f_listname);return(await n.getDefaultColumnValues()).filter(e=>e.path.toLowerCase()===t.DecodedUrl.toLowerCase())},un.prototype.setDefaultColumnValues=async function(e,t=!0){const n=await fn(this,"Properties").select("vti_x005f_listname")(),a=Ze([this,ze(Ge(n))]).lists.getById(n.vti_x005f_listname),i=(await this.select("ServerRelativePath")()).ServerRelativePath.DecodedUrl,r=await a.getDefaultColumnValues(),o=t?r:r.filter(e=>e.path!==i);e.forEach(e=>{const t=o.find(t=>t.name===e.name&&t.path===i);t?t.value=e.value:o.push({name:e.name,path:i,value:e.value})}),await a.setDefaultColumnValues(o)},un.prototype.clearDefaultColumnValues=async function(){await this.setDefaultColumnValues([],!1)};let _n=class extends se{async addAvailableContentType(e){const t=await me(hn(this,"addAvailableContentType"),ne({contentTypeId:e}));return{contentType:this.getById(t.id),data:t}}getById(e){return gn(this).concat(`('${e}')`)}async add(e,t,n="",a="Custom Content Types",i={}){const r=ne({Description:n,Group:a,Id:{StringValue:e},Name:t,...i}),o=await me(this,r);return{contentType:this.getById(o.id),data:o}}};_n=We([qe("contenttypes")],_n);const hn=ie(_n);class bn extends de{constructor(){super(...arguments),this.delete=ue()}async update(e){return _e(this,ne(e))}get fieldLinks(){return yn(this)}get fields(){return ce(this,"fields")}get parent(){return gn(this,"parent")}get workflowAssociations(){return ce(this,"workflowAssociations")}}const gn=ie(bn);let vn=class extends se{getById(e){return Sn(this).concat(`(guid'${e}')`)}};vn=We([qe("fieldlinks")],vn);const yn=ie(vn),Sn=ie(class extends de{});te(Xe,"contentTypes",hn),te(vt,"contentType",gn),te(pt,"contentTypes",hn);let Dn=class extends se{async add(e,t=!1){return{data:await me(In(this,"add"),ne({featdefScope:0,featureId:e,force:t})),feature:this.getById(e)}}getById(e){return xn(this).concat(`('${e}')`)}remove(e,t=!1){return me(In(this,"remove"),ne({featureId:e,force:t}))}};Dn=We([qe("features")],Dn);const In=ie(Dn),xn=ie(class extends de{});te(At,"features",In),te(Xe,"features",In);let Cn=class extends se{async createFieldAsXml(e){return"string"==typeof e&&(e={SchemaXml:e}),me(On(this,"createfieldasxml"),ne({parameters:e}))}getById(e){return En(this).concat(`('${e}')`)}getByTitle(e){return En(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return En(this,`getByInternalNameOrTitle('${e}')`)}async add(e,t,n){return me(On(this,null),ne(Object.assign({__metadata:{type:null!==(a=Ln[t])&&void 0!==a?a:"SP.Field"}},{Title:e,FieldTypeKind:t,...n}),ae({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"})));var a}async addField(e,t,n){return me(On(this,"AddField"),ne({parameters:{Title:e,FieldTypeKind:t,...n}}))}addText(e,t){return this.add(e,2,{MaxLength:255,...t})}addCalculated(e,t){return this.add(e,17,{OutputType:An.Text,...t})}addDateTime(e,t){return this.add(e,4,{DateTimeCalendarType:Tn.Gregorian,DisplayFormat:kn.DateOnly,FriendlyDisplayFormat:Mn.Unspecified,...t})}addNumber(e,t){return this.add(e,9,t)}addCurrency(e,t){return this.add(e,10,{CurrencyLocaleId:1033,...t})}addMultilineText(e,t){return this.add(e,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...t})}addUrl(e,t){return this.add(e,11,{DisplayFormat:Un.Hyperlink,...t})}addUser(e,t){return this.add(e,20,{SelectionMode:Fn.PeopleAndGroups,...t})}async addLookup(e,t){return this.addField(e,7,t)}addChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,6,n)}addMultiChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,15,n)}addBoolean(e,t){return this.add(e,8,t)}async addDependentLookupField(e,t,n){return me(On(this,`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${n}')`))}addLocation(e,t){return this.add(e,33,t)}addImageField(e,t){return this.add(e,34,t)}};Cn=We([qe("fields")],Cn);const On=ie(Cn);class wn extends de{constructor(){super(...arguments),this.delete=ue()}async update(e,t){return null==t&&(t=(await En(this).select("FieldTypeKind")())["odata.type"]),_e(this,ne(e))}setShowInDisplayForm(e){return me(En(this,`setshowindisplayform(${e})`))}setShowInEditForm(e){return me(En(this,`setshowineditform(${e})`))}setShowInNewForm(e){return me(En(this,`setshowinnewform(${e})`))}}const En=ie(wn);var An;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType",e[e.Location=33]="Location",e[e.Image=34]="Image"}(An||(An={}));const Ln={[An.Calculated]:"SP.FieldCalculated",[An.Choice]:"SP.FieldChoice",[An.Computed]:"SP.FieldComputed",[An.Currency]:"SP.FieldCurrency",[An.DateTime]:"SP.FieldDateTime",[An.GridChoice]:"SP.FieldRatingScale",[An.Guid]:"SP.FieldGuid",[An.Image]:"SP.FieldMultiLineText",[An.Integer]:"SP.FieldNumber",[An.Location]:"SP.FieldLocation",[An.Lookup]:"SP.FieldLookup",[An.ModStat]:"SP.FieldChoice",[An.MultiChoice]:"SP.FieldMultiChoice",[An.Note]:"SP.FieldMultiLineText",[An.Number]:"SP.FieldNumber",[An.Text]:"SP.FieldText",[An.URL]:"SP.FieldUrl",[An.User]:"SP.FieldUser",[An.WorkflowStatus]:"SP.FieldChoice",[An.WorkflowEventType]:"SP.FieldNumber"};var kn,Mn,Pn,Tn,Un,Fn,Hn;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(kn||(kn={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(Mn||(Mn={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(Pn||(Pn={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(Tn||(Tn={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(Un||(Un={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(Fn||(Fn={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(Hn||(Hn={})),te(Xe,"fields",On),te(Xe,"availablefields",On),te(pt,"fields",On),te(un,"files",Ft),te(vt,"file",Rt,"file"),te(vt,"folder",fn),te(pt,"rootFolder",fn),te(Xe,"folders",ln),te(Xe,"rootFolder",fn),Xe.prototype.getFolderByServerRelativePath=function(e){return pn(this,e)},Xe.prototype.getFolderById=function(e){return fn(this,`getFolderById('${e}')`)};let Rn=class extends se{getById(e){return Bn(this).concat(`('${e}')`)}};Rn=We([qe("forms")],Rn);const Nn=ie(Rn),Bn=ie(class extends de{});te(pt,"forms",Nn);let jn=class extends de{canUserCreateGroup(){return pe(Vn(this,"CanUserCreateGroup"))}clearCurrentUserTeamsCache(){return me(Vn(this,"ClearCurrentUserTeamsCache"))}create(e){return me(Vn(this,"Create"),ne({groupId:e}))}createGroup(e,t,n,a,i,r){return me(Vn(this,"CreateGroup"),ne({displayName:e,alias:t,isPublic:n,ownerPrincipalNames:a,description:i,creationOptions:r}))}delete(e){return me(Vn(this,"Delete"),ne({siteUrl:e}))}ensureTeamForGroup(){return me(Vn(this,"EnsureTeamForGroup"))}ensureTeamForGroupEx(){return me(Vn(this,"EnsureTeamForGroupEx"))}getAllOrgLabels(e){return me(Vn(this,"GetAllOrgLabels"),ne({pageNumber:e}))}getCurrentUserJoinedTeams(e,t){return me(Vn(this,"GetCurrentUserJoinedTeams"),ne({getLogoData:e,forceCacheUpdate:t}))}getCurrentUserSharedChannelMemberGroups(){return me(Vn(this,"GetCurrentUserSharedChannelMemberGroups"))}getCurrentUserTeamConnectedMemberGroups(){return me(Vn(this,"GetCurrentUserTeamConnectedMemberGroups"))}getGroupCreationContext(){return pe(Vn(this,"GetGroupCreationContext"))}getGroupSiteConversionData(){return pe(Vn(this,"GetGroupSiteConversionData"))}getSiteStatus(e){return me(Vn(this,"GetSiteStatus"),ne({groupId:e}))}getTeamChannelFilesUrl(e,t){return me(Vn(this,"GetTeamChannelFilesUrl").using(z()),ne({teamId:e,channelId:t}))}getTeamChannels(e,t){return me(Vn(this,"GetTeamChannels").using(z()),ne({teamId:e,useStagingEndpoint:t}))}getTeamChannelsDirect(e){return me(Vn(this,"GetTeamChannelsDirect"),ne({teamId:e}))}getTeamChannelsEx(e){return me(Vn(this,"GetTeamChannelsEx"),ne({teamId:e}))}getTeamChannelsWithSiteUrl(e){return me(Vn(this,"GetTeamChannelsWithSiteUrl"),ne({siteUrl:e}))}getUserSharedChannelMemberGroups(e){return me(Vn(this,"GetUserSharedChannelMemberGroups"),ne({userName:e}))}getUserTeamConnectedMemberGroups(e){return me(Vn(this,"GetUserTeamConnectedMemberGroups"),ne({userName:e}))}getValidSiteUrlFromAlias(e,t,n){return me(Vn(this,"GetValidSiteUrlFromAlias"),ne({alias:e,managedPath:t,isTeamSite:n}))}isTeamifyPromptHidden(e){return me(Vn(this,"IsTeamifyPromptHidden"),ne({siteUrl:e}))}notebook(e){return me(Vn(this,"Notebook"),ne({groupId:e}))}pinToTeam(e){return me(Vn(this,"PinToTeam"),ne({requestParams:e}))}call(e,t){const n=Vn(this,e);return void 0!==t?me(n,ne(t)):me(n)}};jn=We([qe("_api/groupsitemanager")],jn);const Vn=ie(jn);Reflect.defineProperty(He.prototype,"groupSiteManager",{configurable:!0,enumerable:!0,get:function(){return this.create(Vn)}});let zn=class extends se{getById(e){return Kn(this,`GetById?hubSiteId='${e}'`)}};zn=We([qe("_api/hubsites")],zn);const Gn=ie(zn),Kn=ie(class extends de{async getSite(){const e=await this.select("SiteUrl")();return Lt([this,e.SiteUrl])}});At.prototype.joinHubSite=async function(e){await me(Lt(this,`joinHubSite('${e}')`))},At.prototype.registerHubSite=async function(){await me(Lt(this,"registerHubSite"))},At.prototype.unRegisterHubSite=async function(){await me(Lt(this,"unRegisterHubSite"))},Xe.prototype.hubSiteData=async function(e=!1){const t=await Ze(this,`hubSiteData(${e})`)();return"string"==typeof t?JSON.parse(t):t},Xe.prototype.syncHubSiteTheme=function(){return me(Ze(this,"syncHubSiteTheme"))},Reflect.defineProperty(He.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return this.create(Gn)}});const Wn=ie(class extends se{getById(e){return qn(this).concat(`(${e})`)}async add(e,t,n=!0){const a=ne({IsVisible:n,Title:e,Url:t});return me(Wn(this,null),a)}moveAfter(e,t){const n=ne({nodeId:e,previousNodeId:t});return me(Wn(this,"MoveAfter"),n)}}),qn=ie(class extends de{constructor(){super(...arguments),this.delete=ue()}get children(){return Wn(this,"children")}async update(e){return{data:await _e(this,ne(e)),node:this}}});let Qn=class extends re{get quicklaunch(){return Wn(this,"quicklaunch")}get topNavigationBar(){return Wn(this,"topnavigationbar")}};Qn=We([qe("navigation")],Qn);const Yn=ie(Qn);class Jn extends re{constructor(e=null,t){super(e,t),this._url=i(ze(this._url),"_api/navigation",t)}getMenuState(e=null,t=10,n=null,a=null){return me(Xn(this,"MenuState"),ne({customProperties:a,depth:t,mapProviderName:n,menuNodeKey:e}))}getMenuNodeKey(e,t=null){return me(Xn(this,"MenuNodeKey"),ne({currentUrl:e,mapProviderName:t}))}}const Xn=(e,t)=>new Jn(e,t);te(Xe,"navigation",Yn),Reflect.defineProperty(He.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return this.create(Xn)}});const Zn=ie(class extends de{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new ta(e).using(A(this)),this.profileLoader=new $n(e).using(A(this))}getEditProfileLink(){return Zn(this,"EditProfileLink")()}getIsMyPeopleListPublic(){return Zn(this,"IsMyPeopleListPublic")()}amIFollowedBy(e){const t=Zn(this,"amifollowedby(@v)");return t.query.set("@v",`'${e}'`),t()}amIFollowing(e){const t=Zn(this,"amifollowing(@v)");return t.query.set("@v",`'${e}'`),t()}getFollowedTags(e=20){return Zn(this,`getfollowedtags(${e})`)()}getFollowersFor(e){const t=Zn(this,"getfollowersfor(@v)");return t.query.set("@v",`'${e}'`),t()}get myFollowers(){return ce(this,"getmyfollowers")}get myProperties(){return Zn(this,"getmyproperties")}getPeopleFollowedBy(e){const t=Zn(this,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${e}'`),t()}getPropertiesFor(e){const t=Zn(this,"getpropertiesfor(@v)");return t.query.set("@v",`'${e}'`),t()}get trendingTags(){const e=Zn(this,null);return e.concat(".gettrendingtags"),e()}getUserProfilePropertyFor(e,t){const n=Zn(this,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return n.query.set("@v",`'${e}'`),n()}hideSuggestion(e){const t=Zn(this,"hidesuggestion(@v)");return t.query.set("@v",`'${e}'`),me(t)}isFollowing(e,t){const n=Zn(this,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v",`'${e}'`),n.query.set("@y",`'${t}'`),n()}setMyProfilePic(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=async e=>{const a=e.target.result;try{await me(Zn(this,"setmyprofilepicture"),{body:a}),t()}catch(e){n(e)}},a.readAsArrayBuffer(e)})}setSingleValueProfileProperty(e,t,n){return me(Zn(this,"SetSingleValueProfileProperty"),ne({accountName:e,propertyName:t,propertyValue:n}))}setMultiValuedProfileProperty(e,t,n){return me(Zn(this,"SetMultiValuedProfileProperty"),ne({accountName:e,propertyName:t,propertyValues:n}))}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}});let $n=class extends re{createPersonalSiteEnqueueBulk(e){return me(ea(this,"createpersonalsiteenqueuebulk"),ne({emailIDs:e}))}get ownerUserProfile(){return me(this.getParent(ea,"_api/sp.userprofiles.profileloader.getowneruserprofile"))}get userProfile(){return me(ea(this,"getuserprofile"))}createPersonalSite(e=!1){return me(ea(this,`getuserprofile/createpersonalsiteenque(${e})`))}shareAllSocialData(e){return me(ea(this,`getuserprofile/shareallsocialdata(${e})`))}};$n=We([qe("_api/sp.userprofiles.profileloader.getprofileloader")],$n);const ea=(e,t)=>new $n(e,t);let ta=class extends re{async clientPeoplePickerResolveUser(e){const t=na(this,null);t.concat(".clientpeoplepickerresolveuser");const n=await me(t,this.getBodyFrom(e));return JSON.parse("object"==typeof n?n.ClientPeoplePickerResolveUser:n)}async clientPeoplePickerSearchUser(e){const t=na(this,null);t.concat(".clientpeoplepickersearchuser");const n=await me(t,this.getBodyFrom(e));return JSON.parse("object"==typeof n?n.ClientPeoplePickerSearchUser:n)}getBodyFrom(e){return ne({queryParams:e})}};ta=We([qe("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],ta);const na=(e,t)=>new ta(e,t);var aa;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(aa||(aa={})),Reflect.defineProperty(He.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return this.create(Zn)}});const ia=ie(class extends de{constructor(e,t="_api/SP.Publishing.SitePageService"){super(e,t)}getCurrentUserMemberships(){const e=ia(this,null);return e.concat(".GetCurrentUserMemberships"),e()}});Reflect.defineProperty(He.prototype,"publishingSitePageService",{get:function(){return this.create(ia)}});let ra=class extends de{get timeZone(){return ca(this)}get timeZones(){return la(this)}async getInstalledLanguages(){return(await ce(this,"installedlanguages")()).Items}};ra=We([qe("regionalsettings")],ra);const oa=ie(ra);let sa=class extends de{async utcToLocalTime(e){let t;t="string"==typeof e?e:e.toISOString();const n=await me(ca(this,`utctolocaltime('${t}')`));return m(n,"UTCToLocalTime")?n.UTCToLocalTime:n}async localTimeToUTC(e){let t;t="string"==typeof e?e:a(e,"minute",-1*e.getTimezoneOffset()).toISOString();const n=await me(ca(this,`localtimetoutc('${t}')`));return m(n,"LocalTimeToUTC")?n.LocalTimeToUTC:n}};sa=We([qe("timezone")],sa);const ca=ie(sa);let da=class extends se{getById(e){return me(la(this,`GetById(${e})`))}};da=We([qe("timezones")],da);const la=ie(da);function ua(e){return function(t){return me(oe(this,`${e}/getValueForUICulture`),ne({cultureName:t}))}}te(Xe,"regionalSettings",oa),Xe.prototype.titleResource=ua("titleResource"),Xe.prototype.descriptionResource=ua("descriptionResource");let fa=class extends se{getById(e){return _a(this).concat(`('${e}')`)}async add(e){const t=await me(this,ne(e));return{action:this.getById(t.Id),data:t}}clear(){return me(pa(this,"clear"))}};fa=We([qe("usercustomactions")],fa);const pa=ie(fa);class ma extends de{constructor(){super(...arguments),this.delete=ue()}async update(e){return{data:await _e(this,ne(e)),action:this}}}const _a=ie(ma);var ha,ba;!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(ha||(ha={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(ba||(ba={})),ma.prototype.titleResource=ua("titleResource"),ma.prototype.descriptionResource=ua("descriptionResource"),pt.prototype.titleResource=ua("titleResource"),pt.prototype.descriptionResource=ua("descriptionResource"),wn.prototype.titleResource=ua("titleResource"),wn.prototype.descriptionResource=ua("descriptionResource"),bn.prototype.titleResource=ua("nameResource"),bn.prototype.descriptionResource=ua("descriptionResource");let ga=class extends re{getRelatedItems(e,t){const n=va(this);return n.concat(".GetRelatedItems"),me(n,ne({SourceItemID:t,SourceListName:e}))}getPageOneRelatedItems(e,t){const n=va(this);return n.concat(".GetPageOneRelatedItems"),me(n,ne({SourceItemID:t,SourceListName:e}))}addSingleLink(e,t,n,a,i,r,o=!1){const s=va(this);return s.concat(".AddSingleLink"),me(s,ne({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:a,TargetWebUrl:r,TryAddReverseLink:o}))}addSingleLinkToUrl(e,t,n,a=!1){const i=va(this);return i.concat(".AddSingleLinkToUrl"),me(i,ne({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:a}))}addSingleLinkFromUrl(e,t,n,a=!1){const i=va(this);return i.concat(".AddSingleLinkFromUrl"),me(i,ne({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:a}))}deleteSingleLink(e,t,n,a,i,r,o=!1){const s=va(this);return s.concat(".DeleteSingleLink"),me(s,ne({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:a,TargetWebUrl:r,TryDeleteReverseLink:o}))}};ga=We([qe("_api/SP.RelatedItemManager")],ga);const va=e=>new ga("string"==typeof e?ze(e):[e,ze(e.toUrl())]);var ya;Reflect.defineProperty(Xe.prototype,"relatedItems",{configurable:!0,enumerable:!0,get:function(){return va(this)}}),new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),new Map([]);let Sa=ya=class extends de{async run(e){const t=this.parseQuery(e),n=ne({request:{...t,HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}}),a=new ya([this,this.parentUrl]);var i;a.using(e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheAlways":"1"},[e,t,n]}),e),(i=function(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}(JSON.stringify(n)).toString(),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-CacheKey":i},[e,t,n]}),e)));const r=await me(a,n);return new Da(r,new ya([this,this.parentUrl]),t)}fixArrProp(e){return void 0===e?[]:d(e)?e:[e]}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e,t}};Sa=ya=We([qe("_api/search/postquery"),B(function(e){return this.run(e)})],Sa),ie(Sa);class Da{constructor(e,t,n,a=null,i=null){this._search=t,this._query=n,this._raw=a,this._primary=i,this._raw=e.postquery?e.postquery:e}get ElapsedTime(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0}get RowCount(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.RowCount)||0}get TotalRows(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRows)||0}get TotalRowsIncludingDuplicates(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRowsIncludingDuplicates)||0}get RawSearchResults(){return this._raw}get PrimarySearchResults(){var e,t,n,a;return null===this._primary&&(this._primary=this.formatSearchResults((null===(a=null===(n=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===a?void 0:a.Rows)||null)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const n=void 0!==t?t:m(this._query,"RowLimit")?this._query.RowLimit:10,a={...this._query,RowLimit:n,StartRow:n*(e-1)};return a.StartRow>this.TotalRows?Promise.resolve(null):this._search.run(a)}formatSearchResults(e){const t=new Array;if(void 0===e||null==e)return[];const n=e.results?e.results:e;for(const e of n){const n=e.Cells.results?e.Cells.results:e.Cells;t.push(n.reduce((e,t)=>(e[t.Key]=t.Value,e),{}))}return t}}let Ia=class extends de{async run(e){this.mapQueryToQueryString(e);const t=await this(),n=m(t,"suggest")?e=>t.suggest[e].results:e=>t[e];return{PeopleNames:n("PeopleNames"),PersonalResults:n("PersonalResults"),Queries:n("Queries")}}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>n=>{m(e,t)&&this.query.set(n,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};var xa,Ca,Oa;Ia=We([qe("_api/search/suggest")],Ia),ie(Ia),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(xa||(xa={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(Ca||(Ca={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(Oa||(Oa={}));class wa{}wa.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",wa.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",wa.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",wa.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",wa.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",wa.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",wa.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",wa.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",wa.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",wa.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",wa.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",wa.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",wa.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",wa.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",wa.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",He.prototype.search=function(e){return new Sa(this._root).run(e)},He.prototype.searchSuggest=function(e){return new Ia(this._root).run("string"==typeof e?{querytext:e}:e)};let Ea=class extends se{getById(e){return La(this,`getById(${e})`)}getByEmail(e){return La(this,`getByEmail('${e}')`)}getByLoginName(e){return La(this).concat(`('!@v::${e}')`)}removeById(e){return me(Aa(this,`removeById(${e})`))}removeByLoginName(e){const t=Aa(this,"removeByLoginName(@v)");return t.query.set("@v",`'${e}'`),me(t)}async add(e){return await me(this,ne({LoginName:e})),this.getByLoginName(e)}};Ea=We([qe("siteusers")],Ea);const Aa=ie(Ea),La=ie(class extends de{constructor(){super(...arguments),this.delete=ue()}get groups(){return Ma(this,"groups")}async update(e){return _e(this,ne(e))}});let ka=class extends se{getById(e){return Pa(this).concat(`(${e})`)}async add(e){return me(this,ne(e))}getByName(e){return Pa(this,`getByName('${e}')`)}removeById(e){return me(Ma(this,`removeById('${e}')`))}removeByLoginName(e){return me(Ma(this,`removeByLoginName('${e}')`))}};ka=We([qe("sitegroups")],ka);const Ma=ie(ka),Pa=ie(class extends de{get users(){return Aa(this,"users")}async update(e){return _e(this,ne(e))}setUserAsOwner(e){return me(Pa(this,`SetUserAsOwner(${e})`))}});let Ta=class extends se{getById(e){return Fa(this).concat(`(${e})`)}async add(e,t){await me(Ua(this,`addroleassignment(principalid=${e}, roledefid=${t})`))}async remove(e,t){await me(Ua(this,`removeroleassignment(principalid=${e}, roledefid=${t})`))}};Ta=We([qe("roleassignments")],Ta);const Ua=ie(Ta),Fa=ie(class extends de{constructor(){super(...arguments),this.delete=ue()}get groups(){return Ma(this,"groups")}get bindings(){return ce(this,"roledefinitionbindings")}});let Ha=class extends se{getById(e){return Na(this,`getById(${e})`)}getByName(e){return Na(this,`getbyname('${e}')`)}getByType(e){return Na(this,`getbytype(${e})`)}async add(e,t,n,a){const i=ne({BasePermissions:{High:a.High.toString(),Low:a.Low.toString()},Description:t,Name:e,Order:n}),r=await me(this,i);return{data:r,definition:this.getById(r.Id)}}};Ha=We([qe("roledefinitions")],Ha);const Ra=ie(Ha),Na=ie(class extends de{constructor(){super(...arguments),this.delete=ue()}async update(e){const t=["BasePermissions"];if(void 0!==m(e,t[0])){const n=e[t[0]];n.High=n.High.toString(),n.Low=n.Low.toString()}const n=await _e(this,ne(e));let a=this;return m(e,"Name")&&(a=this.getParent(Ra).getByName(e.Name)),{data:n,definition:a}}});var Ba,ja,Va,za,Ga,Ka,Wa;async function qa(e){const t=le(this,"getUserEffectivePermissions(@user)");return t.query.set("@user",`'${e}'`),t()}async function Qa(){return oe(this,"EffectiveBasePermissions")()}async function Ya(e=!1,t=!1){return me(oe(this,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`))}async function Ja(){return me(oe(this,"resetroleinheritance"))}async function Xa(e,t){const n=await qa.call(this,e);return this.hasPermissions(n,t)}async function Za(e){const t=await Qa.call(this);return this.hasPermissions(t,e)}function $a(e,t){if(!t)return!0;if(t===Ba.FullMask)return!(32767&~e.High)&&65535===e.Low;let n=1;return(t-=1)>=0&&t<32?(n<<=t,0!==(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!==(e.High&n))}!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(Ba||(Ba={})),te(vt,"roleAssignments",Ua),te(vt,"firstUniqueAncestorSecurableObject",le),vt.prototype.getUserEffectivePermissions=qa,vt.prototype.getCurrentUserEffectivePermissions=Qa,vt.prototype.breakRoleInheritance=Ya,vt.prototype.resetRoleInheritance=Ja,vt.prototype.userHasPermissions=Xa,vt.prototype.currentUserHasPermissions=Za,vt.prototype.hasPermissions=$a,te(pt,"roleAssignments",Ua),te(pt,"firstUniqueAncestorSecurableObject",le),pt.prototype.getUserEffectivePermissions=qa,pt.prototype.getCurrentUserEffectivePermissions=Qa,pt.prototype.breakRoleInheritance=Ya,pt.prototype.resetRoleInheritance=Ja,pt.prototype.userHasPermissions=Xa,pt.prototype.currentUserHasPermissions=Za,pt.prototype.hasPermissions=$a,te(Xe,"roleDefinitions",Ra),te(Xe,"roleAssignments",Ua),te(Xe,"firstUniqueAncestorSecurableObject",le),Xe.prototype.getUserEffectivePermissions=qa,Xe.prototype.getCurrentUserEffectivePermissions=Qa,Xe.prototype.breakRoleInheritance=Ya,Xe.prototype.resetRoleInheritance=Ja,Xe.prototype.userHasPermissions=Xa,Xe.prototype.currentUserHasPermissions=Za,Xe.prototype.hasPermissions=$a,function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(ja||(ja={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(Va||(Va={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(za||(za={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(Ga||(Ga={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(Ka||(Ka={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(Wa||(Wa={})),Ht.prototype.shareWith=async function(e,t=ja.View,n=!1,a){return(await this.getItem()).shareWith(e,t,n,a)},Ht.prototype.getShareLink=async function(e,t=null){return(await this.getItem()).getShareLink(e,t)},Ht.prototype.checkSharingPermissions=async function(e){return(await this.getItem()).checkSharingPermissions(e)},Ht.prototype.getSharingInformation=async function(e=null,t,n){return(await this.getItem()).getSharingInformation(e,t,n)},Ht.prototype.getObjectSharingSettings=async function(e=!0){return(await this.getItem()).getObjectSharingSettings(e)},Ht.prototype.unshare=async function(){return(await this.getItem()).unshare()},Ht.prototype.deleteSharingLinkByKind=async function(e){return(await this.getItem()).deleteSharingLinkByKind(e)},Ht.prototype.unshareLink=async function(e,t=Ne){return(await this.getItem()).unshareLink(e,t)};const ei="odata.id";async function ti(e,t,n=!1){if(n)return ni(e,t);t={group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0,...t};const a=await ai.apply(e,[t.role,t.group]);d(t.loginNames)||(t.loginNames=[t.loginNames]);let i={peoplePickerInput:p(t.loginNames.map(e=>({Key:e}))),roleValue:a,url:t.url};return void 0!==t.emailData&&null!==t.emailData&&(i={emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0,...i}),ni(e,i)}async function ni(e,t){const n=Ze([e,ze(e.toUrl())],"/_api/SP.Web.ShareObject");return me(n.expand("UsersWithAccessRequests","GroupsSharedWith"),ne(t))}async function ai(e,t){if(null==t){const t=e===ja.Edit?Wa.Contributor:Wa.Reader,n=await Ra([this,"_api/web"]).select("Id").top(1).filter(`RoleTypeKind eq ${t}`)();if(void 0===n||(null==n?void 0:n.length)<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${n[0].Id}`}switch(t){case Wa.Contributor:return`group: ${(await Ze([this,"_api/web"],"associatedmembergroup").select("Id")()).Id}`;case Wa.Reader:case Wa.Guest:return`group: ${(await Ze([this,"_api/web"],"associatedvisitorgroup").select("Id")()).Id}`;default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}}un.prototype.shareWith=async function(e,t=ja.View,n=!1,a){return(await this.getItem(ei)).shareWith(e,t,n,a)},un.prototype.getShareLink=async function(e,t=null){return(await this.getItem(ei)).getShareLink(e,t)},un.prototype.checkSharingPermissions=async function(e){return(await this.getItem(ei)).checkSharingPermissions(e)},un.prototype.getSharingInformation=async function(e,t,n){return(await this.getItem(ei)).getSharingInformation(e,t,n)},un.prototype.getObjectSharingSettings=async function(e=!0){return(await this.getItem(ei)).getObjectSharingSettings(e)},un.prototype.unshare=async function(){return(await this.getItem(ei)).unshare()},un.prototype.deleteSharingLinkByKind=async function(e){return(await this.getItem(ei)).deleteSharingLinkByKind(e)},un.prototype.unshareLink=async function(e,t){return(await this.getItem(ei)).unshareLink(e,t)},vt.prototype.shareWith=function(e,t=ja.View,n=!1,a){return async function(e,t,n,a=!1,i=!1,r){d(t)||(t=[t]);const o=p(t.map(e=>({Key:e}))),s=n===ja.Edit?Wa.Contributor:Wa.Reader,c=await ce([e,ze(e.toUrl())],"_api/web/roledefinitions").select("Id").filter(`RoleTypeKind eq ${s}`)();if(!d(c)||c.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${s}`);let l={includeAnonymousLinkInEmail:a,peoplePickerInput:o,propagateAcl:i,roleValue:`role:${c[0].Id}`,useSimplifiedRoles:!0};return void 0!==r&&(l={...l,emailBody:r.body,emailSubject:void 0!==r.subject?r.subject:"",sendEmail:!0}),me(le(e,"shareObject"),ne(l))}(this,e,t,n,!1,a)},vt.prototype.getShareLink=function(e,t=null){const n=null!==t?t.toISOString():null,a=le(this,"shareLink");return me(a,ne({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}}))},vt.prototype.checkSharingPermissions=function(e){const t=le(this,"checkPermissions");return me(t,ne({recipients:e}))},vt.prototype.getSharingInformation=function(e=null,t=[],n=["*"]){const a=le(this,"getSharingInformation");return me(a.select(...n).expand(...t),ne({request:e}))},vt.prototype.getObjectSharingSettings=function(e=!0){const t=le(this,"getObjectSharingSettings");return me(t,ne({useSimplifiedRoles:e}))},vt.prototype.unshare=function(){return me(le(this,"unshareObject"))},vt.prototype.deleteSharingLinkByKind=function(e){return me(le(this,"deleteLinkByKind"),ne({linkKind:e}))},vt.prototype.unshareLink=function(e,t=Ne){return me(le(this,"unshareLink"),ne({linkKind:e,shareId:t}))},Xe.prototype.shareWith=async function(e,t=ja.View,n){const a=await this.select("Url")();return this.shareObject(i(a.Url,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,n)},Xe.prototype.shareObject=function(e,t,n,a,i,r=!1,o=!1,s=!0){return ti(this,{emailData:a,group:i,includeAnonymousLinkInEmail:o,loginNames:t,propagateAcl:r,role:n,url:e,useSimplifiedRoles:s})},Xe.prototype.shareObjectRaw=function(e){return ti(this,e,!0)},Xe.prototype.unshareObject=function(e){return me(Ze(this,"unshareObject"),ne({url:e}))};class ii extends re{constructor(e,t=""){super(e),this._url=i(ze(this._url),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}run(e){return me(this,ne(e,ae({"Content-Type":"application/json;charset=utf-8"})))}createSiteDesign(e){return oi(this,"CreateSiteDesign").run({info:e})}applySiteDesign(e,t){return oi(this,"ApplySiteDesign").run({siteDesignId:e,webUrl:t})}getSiteDesigns(){return oi(this,"GetSiteDesigns").run({})}getSiteDesignMetadata(e){return oi(this,"GetSiteDesignMetadata").run({id:e})}updateSiteDesign(e){return oi(this,"UpdateSiteDesign").run({updateInfo:e})}deleteSiteDesign(e){return oi(this,"DeleteSiteDesign").run({id:e})}getSiteDesignRights(e){return oi(this,"GetSiteDesignRights").run({id:e})}grantSiteDesignRights(e,t,n=1){return oi(this,"GrantSiteDesignRights").run({grantedRights:n.toString(),id:e,principalNames:t})}revokeSiteDesignRights(e,t){return oi(this,"RevokeSiteDesignRights").run({id:e,principalNames:t})}addSiteDesignTask(e,t){return oi(this,"AddSiteDesignTask").run({webUrl:e,siteDesignId:t})}addSiteDesignTaskToCurrentWeb(e){return oi(this,"AddSiteDesignTaskToCurrentWeb").run({siteDesignId:e})}async getSiteDesignTask(e){const t=await oi(this,"GetSiteDesignTask").run({taskId:e});return m(t,"ID")?t:null}getSiteDesignRun(e,t){return oi(this,"GetSiteDesignRun").run({webUrl:e,siteDesignId:t})}getSiteDesignRunStatus(e,t){return oi(this,"GetSiteDesignRunStatus").run({webUrl:e,runId:t})}}const ri=(e,t)=>new ii(e,t),oi=(e,t="")=>ri(e,t);var si,ci,di;!function(e){e[e.Site=0]="Site",e[e.List=1]="List"}(si||(si={})),function(e){e[e.DarkRed=0]="DarkRed",e[e.Red=1]="Red",e[e.Orange=2]="Orange",e[e.Green=3]="Green",e[e.DarkGreen=4]="DarkGreen",e[e.Teal=5]="Teal",e[e.Blue=6]="Blue",e[e.NavyBlue=7]="NavyBlue",e[e.BluePurple=8]="BluePurple",e[e.DarkBlue=9]="DarkBlue",e[e.Lavendar=10]="Lavendar",e[e.Pink=11]="Pink"}(ci||(ci={})),function(e){e[e.Bug=0]="Bug",e[e.Calendar=1]="Calendar",e[e.BullseyeTarget=2]="BullseyeTarget",e[e.ClipboardList=3]="ClipboardList",e[e.Airplane=4]="Airplane",e[e.Rocket=5]="Rocket",e[e.Color=6]="Color",e[e.Insights=7]="Insights",e[e.CubeShape=8]="CubeShape",e[e.TestBeakerSolid=9]="TestBeakerSolid",e[e.Robot=10]="Robot",e[e.Savings=11]="Savings"}(di||(di={})),Xe.prototype.getSiteDesignRuns=function(e){return ri(this,"").getSiteDesignRun(void 0,e)},Xe.prototype.addSiteDesignTask=function(e){return ri(this,"").addSiteDesignTaskToCurrentWeb(e)},Xe.prototype.getSiteDesignRunStatus=function(e){return ri(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(He.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return this.create(ri)}}),te(Xe,"siteGroups",Ma),te(Xe,"associatedOwnerGroup",Pa),te(Xe,"associatedMemberGroup",Pa),te(Xe,"associatedVisitorGroup",Pa),Xe.prototype.createDefaultAssociatedGroups=async function(e,t,n=!1,a=!0,i){await this.breakRoleInheritance(n,a);const r=Ze(this,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return r.query.set("@u",`'${t||""}'`),r.query.set("@v",`'${i||""}'`),r.query.set("@s",`'${e||""}'`),me(r)};class li extends re{constructor(e,t=""){super(e),this._url=i(ze(this._url),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}run(e){return me(this,ne(e))}getSiteScripts(){return fi(this,"GetSiteScripts").run({})}createSiteScript(e,t,n){return fi(this,`CreateSiteScript(Title=@title,Description=@desc)?@title='${Ke(e)}'&@desc='${Ke(t)}'`).run(n)}getSiteScriptMetadata(e){return fi(this,"GetSiteScriptMetadata").run({id:e})}deleteSiteScript(e){return fi(this,"DeleteSiteScript").run({id:e})}updateSiteScript(e,t){return t&&(e.Content=JSON.stringify(t)),fi(this,"UpdateSiteScript").run({updateInfo:e})}getSiteScriptFromList(e){return fi(this,"GetSiteScriptFromList").run({listUrl:e})}getSiteScriptFromWeb(e,t){return fi(this,"getSiteScriptFromWeb").run({webUrl:e,info:t})}executeSiteScriptAction(e){return fi(this,"executeSiteScriptAction").run({actionDefinition:e})}}const ui=(e,t)=>new li(e,t),fi=(e,t="")=>ui(e,t);var pi;!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NoOp=2]="NoOp",e[e.SucceededWithException=3]="SucceededWithException"}(pi||(pi={})),Xe.prototype.getSiteScript=async function(e){const t=await this.select("Url")();return ui(this.toUrl(),"").using(A(this)).getSiteScriptFromWeb(t.Url,e)},pt.prototype.getSiteScript=async function(){const e=await mt(this).rootFolder(),t=i((await Ze([this,ze(this.toUrl())]).select("Url")()).Url,"Lists",e.Name);return ui(this,"").getSiteScriptFromList(t)},Reflect.defineProperty(He.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return this.create(ui)}}),te(Xe,"siteUsers",Aa),te(Xe,"currentUser",La),Xe.prototype.ensureUser=async function(e){return me(Ze(this,"ensureuser"),ne({logonName:e}))},Xe.prototype.getUserById=function(e){return La(this,`getUserById(${e})`)},Reflect.defineProperty(He.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.create(Lt)}});let mi=class extends de{get my(){return gi(this)}async getFollowedSitesUri(){const e=await hi(this,"FollowedSitesUri")();return e.FollowedSitesUri||e}async getFollowedDocumentsUri(){const e=await hi(this,"FollowedDocumentsUri")();return e.FollowedDocumentsUri||e}async follow(e){return me(hi(this,"follow"),this.createSocialActorInfoRequestBody(e))}async isFollowed(e){return me(hi(this,"isfollowed"),this.createSocialActorInfoRequestBody(e))}async stopFollowing(e){return me(hi(this,"stopfollowing"),this.createSocialActorInfoRequestBody(e))}createSocialActorInfoRequestBody(e){return ne({actor:{Id:null,...e}})}};mi=We([qe("_api/social.following")],mi);const _i=e=>new mi(e),hi=(e,t)=>new mi(e,t);let bi=class extends de{async followed(e){const t=await vi(this,`followed(types=${e})`)();return m(t,"Followed")?t.Followed.results:t}async followedCount(e){const t=await vi(this,`followedcount(types=${e})`)();return t.FollowedCount||t}async followers(){const e=await vi(this,"followers")();return m(e,"Followers")?e.Followers.results:e}async suggestions(){const e=await vi(this,"suggestions")();return m(e,"Suggestions")?e.Suggestions.results:e}};bi=We([qe("my")],bi);const gi=(e,t)=>new bi(e,t),vi=(e,t)=>new bi(e,t);var yi,Si,Di,Ii;!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(yi||(yi={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Si||(Si={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Di||(Di={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(Ii||(Ii={})),Reflect.defineProperty(He.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return this.create(_i)}});const xi=ie(class extends re{constructor(e,t=""){super(e),this._url=i(ze(this._url),`_api/SP.Utilities.Utility.${t}`)}excute(e){return me(this,ne(e))}sendEmail(e){return e.AdditionalHeaders&&(e.AdditionalHeaders=Reflect.ownKeys(e.AdditionalHeaders).map(t=>({Key:t,Value:Reflect.get(e.AdditionalHeaders,t),ValueType:"Edm.String"}))),Ci(this,"SendEmail").excute({properties:e})}getCurrentUserEmailAddresses(){return Ci(this,"GetCurrentUserEmailAddresses").excute({})}resolvePrincipal(e,t,n,a,i,r=!1){const o={addToUserInfoList:i,input:e,inputIsEmailOnly:a,matchUserInfoList:r,scopes:t,sources:n};return Ci(this,"ResolvePrincipalInCurrentContext").excute(o)}searchPrincipals(e,t,n,a,i){const r={groupName:a,input:e,maxCount:i,scopes:t,sources:n};return Ci(this,"SearchPrincipalsUsingContextWeb").excute(r)}createEmailBodyForInvitation(e){const t={pageAddress:e};return Ci(this,"CreateEmailBodyForInvitation").excute(t)}expandGroupsToPrincipals(e,t=30){const n={inputs:e,maxCount:t};return Ci(this,"ExpandGroupsToPrincipals").excute(n)}}),Ci=(e,t)=>xi(e,t);Reflect.defineProperty(He.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return this.create(xi,"")}});let Oi=class extends se{getById(e){return Ei(this).concat(`('${e}')`)}async add(e,t,n){const a={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return n&&(a.clientState=n),me(this,ne(a))}};Oi=We([qe("subscriptions")],Oi);const wi=ie(Oi),Ei=ie(class extends de{async update(e,t,n){const a={};return e&&(a.expirationDateTime=e),t&&(a.notificationUrl=t),n&&(a.clientState=n),ve(this,ne(a))}delete(){return ge(this)}});te(pt,"subscriptions",wi),te(pt,"userCustomActions",pa),te(Xe,"userCustomActions",pa),te(At,"userCustomActions",pa);let Ai=class extends se{async add(e,t=!1,n={}){return me(this,ne({PersonalView:t,Title:e,...n}))}getById(e){return ki(this).concat(`('${e}')`)}getByTitle(e){return ki(this,`getByTitle('${Ke(e)}')`)}};Ai=We([qe("views")],Ai);const Li=ie(Ai),ki=ie(class extends de{constructor(){super(...arguments),this.delete=ue()}get fields(){return Pi(this)}async update(e){return await _e(this,ne(e))}renderAsHtml(){return ki(this,"renderashtml")()}setViewXml(e){return me(ki(this,"SetViewXml"),ne({viewXml:e}))}});let Mi=class extends se{getSchemaXml(){return Pi(this,"schemaxml")()}add(e){return me(Pi(this,`addviewfield('${Ke(e)}')`))}move(e,t){return me(Pi(this,"moveviewfieldto"),ne({field:e,index:t}))}removeAll(){return me(Pi(this,"removeallviewfields"))}remove(e){return me(Pi(this,`removeviewfield('${Ke(e)}')`))}};Mi=We([qe("viewfields")],Mi);const Pi=ie(Mi);var Ti;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(Ti||(Ti={})),te(pt,"views",Li),te(pt,"defaultView",ki),pt.prototype.getView=function(e){return ki(this,`getView('${e}')`)};class Ui extends re{get scope(){return oe(this,"Scope")}get webparts(){return Ri(this,"webparts")}export(e){return me(Hi(this,"ExportWebPart"),ne({webPartId:e}))}import(e){return me(Hi(this,"ImportWebPart"),ne({webPartXml:e}))}}const Fi=(e,t)=>new Ui(e,t),Hi=(e,t)=>Fi(e,t),Ri=ie(class extends se{getById(e){return Ni(this,`getbyid('${e}')`)}getByControlId(e){return Ni(this,`getByControlId('${e}')`)}}),Ni=ie(class extends de{get webpart(){return le(this,"webpart")}saveChanges(){return me(Ni(this,"SaveWebPartChanges"))}moveTo(e,t){return me(Ni(this,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`))}close(){return me(Ni(this,"CloseWebPart"))}open(){return me(Ni(this,"OpenWebPart"))}delete(){return me(Ni(this,"DeleteWebPart"))}});var Bi;let ji;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(Bi||(Bi={})),Ht.prototype.getLimitedWebPartManager=function(e=Bi.Shared){return Fi(this,`getLimitedWebPartManager(scope=${e})`)},Reflect.defineProperty(He.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(Ze)}});const Vi=e=>(!ji&&e&&(ji=Re().using(function(e){return rt.check("SPFx",e),t=>{var n;return t.using(e=>(e.using(function(e,t=!1){return n=>{const a=async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]};return t?n.on.pre.prepend(a):n.on.pre(a),n}}({Accept:"application/json","Content-Type":"application/json;charset=utf-8"})),e),e=>(e.on.pre(async(e,t,n)=>(t.cache="no-cache",t.credentials="same-origin",[e,t,n])),e.using(e=>(e.on.pre(async function(e,t,n){let a="PnPCoreJS:4.13.0:";const{pathname:i}=new URL(e);return a=i.split("/").filter(e=>!u(e)&&["_api","v2.1","v2.0"].indexOf(e)<0).map((e,t,n)=>t===n.length-1?e.replace(/\(.*?$/i,"()"):e[0]).join("."),a.length>32&&(a=a.substring(0,32)),this.log(`Request Tag: ${a}`,0),t.headers={...t.headers,"X-ClientService-ClientTag":a},[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalReject](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolve](e)}),e)),e),function(){const{interval:e,replace:t,retries:n}={replace:!0,interval:200,retries:3};return a=>(t&&a.on.send.clear(),a.on.send(function(t,a){let i,r,o=e,s=0;const c=async()=>{if(s>=n)throw r||new q(`Retry count exceeded (${n}) for this request. ${i.status}: ${i.statusText};`,i);if(s++,void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?o=1e3*parseInt(i.headers.get("Retry-After"),10):o*=2,this.log(`Attempt #${s} to retry request which failed with ${i.status}: ${i.statusText}`,0),await(e=o,new Promise(t=>{setTimeout(t,e)})));try{const e=t.toString();return this.log(`Fetch: ${a.method} ${e}`,0),i=await fetch(e,a),i.ok?i:c()}catch(e){if(/AbortError/.test(e.name))throw e;return r=e,c()}var e};return c()}),a)}(),W(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return K(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),(n=t=>{var n,r,o;if(new RegExp(`^${i(e.pageContext.web.absoluteUrl,"/_api")}`,"i").test(t)&&(null===(r=null===(n=null==e?void 0:e.pageContext)||void 0===n?void 0:n.legacyPageContext)||void 0===r?void 0:r.formDigestValue)){const t=new Date(e.pageContext.legacyPageContext.formDigestValue.split(",")[1]);return{value:e.pageContext.legacyPageContext.formDigestValue,expiration:a(t,"second",(null===(o=e.pageContext.legacyPageContext)||void 0===o?void 0:o.formDigestTimeoutSeconds)-15||1585)}}},e=>(e.on.pre(async function(e,t,r){return this.on.auth(async(e,t)=>{if(/get/i.test(t.method)||t.headers&&(m(t.headers,"X-RequestDigest")||m(t.headers,"Authorization")||m(t.headers,"X-PnPjs-NoDigest")))return[e,t];const r=e.toString(),o=ze(r);let s=at(it.get(o));return!f(s)&&c(n)&&(s=at(n(r))),f(s)||(s=await me(oe([this,i(o,"_api/contextinfo")]).using(V(),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)),{headers:{Accept:"application/json","X-PnPjs-NoDigest":"1"}}).then(e=>({expiration:a(new Date,"second",e.FormDigestTimeoutSeconds),value:e.FormDigestValue}))),f(s)&&(t.headers={"X-RequestDigest":s.value,...t.headers},it.set(o,s)),[e,t]}),[e,t,r]}),e))),t.on.pre.prepend(async(t,n,a)=>(l(t)||(t=i(e.pageContext.web.absoluteUrl,t)),[t,n,a])),t}}(e))),ji);class zi extends t.Component{constructor(e){super(e),this.state={items:[],customFields:[],loading:!0},this.sp=Vi()}componentDidMount(){this.loadAllDocuments()}loadAllDocuments(){return e=this,n=function*(){this.setState({loading:!0});try{const e=yield this.sp.web.lists.filter("BaseTemplate eq 101").select("Title","Id")(),t=[],n=new Map;for(const a of e){(yield this.sp.web.lists.getById(a.Id).fields.filter("Group eq 'Columnas personalizadas' or Group eq 'Custom Columns'").select("Title","InternalName")()).forEach(e=>n.set(e.InternalName,e.Title));const e=Array.from(n.keys()),i=["FileLeafRef","Modified","Editor/Title","FileRef",...e],r=(yield this.sp.web.lists.getById(a.Id).items.select(...i).expand("Editor")()).map(t=>{var n;const i={name:t.FileLeafRef,modified:new Date(t.Modified),modifiedBy:(null===(n=t.Editor)||void 0===n?void 0:n.Title)||"",url:window.location.origin+t.FileRef,library:a.Title};return e.forEach(e=>i[e]=t[e]),i});t.push(...r)}const a=Array.from(n.entries()).map(([e,t])=>({internalName:e,title:t}));this.setState({items:t,customFields:a,loading:!1})}catch(e){console.error("Error loading documents:",e),this.setState({loading:!1})}},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n}render(){return t.createElement("div",null,t.createElement("h3",null,"Todos los documentos"),t.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},t.createElement("thead",{style:{background:"#ddd"}},t.createElement("tr",null,t.createElement("th",null,"Nombre"),t.createElement("th",null,"Modificado"),t.createElement("th",null,"Modificado por"),t.createElement("th",null,"Biblioteca"),this.state.customFields.map(e=>t.createElement("th",{key:e.internalName},e.title)))),t.createElement("tbody",null,this.state.items.map((e,n)=>t.createElement("tr",{key:n},t.createElement("td",null,t.createElement("a",{href:e.url,target:"_blank",rel:"noreferrer"},e.name)),t.createElement("td",null,e.modified.toLocaleDateString()),t.createElement("td",null,e.modifiedBy),t.createElement("td",null,e.library),this.state.customFields.map(n=>t.createElement("td",{key:n.internalName},e[n.internalName])))))),this.state.loading&&t.createElement("p",null,"Cargando..."))}}class Gi extends e.BaseClientSideWebPart{onInit(){const e=Object.create(null,{onInit:{get:()=>super.onInit}});return t=this,a=function*(){return yield e.onInit.call(this),Vi(this.context),Promise.resolve()},new((n=void 0)||(n=Promise))(function(e,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(t,[])).next())});var t,n,a}render(){const e=t.createElement(zi,{});n.render(e,this.domElement)}}})(),o})());